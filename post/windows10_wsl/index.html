<!doctype html><html lang=zh-CN data-theme=dark><head><meta charset=UTF-8><meta name=viewport content="width=device-width"><meta name=theme-color content="#222" media="(prefers-color-scheme: dark)"><meta name=generator content="Hugo 0.143.1"><link rel="shortcut icon" type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/imgs/icons/favicon_16x16_next.png><link rel=icon type=image/png sizes=32x32 href=/imgs/icons/favicon_32_32_next.png><link rel=apple-touch-icon sizes=180x180 href=/imgs/icons/apple_touch_icon_next.png><meta itemprop=name content="windows10 WSL setup"><meta itemprop=description content><meta itemprop=datePublished zgotmplz><meta itemprop=dateModified zgotmplz><meta itemprop=image content="/imgs/luyang_avatar.png"><meta itemprop=keywords content="windows,wsl,linux,ext4,usbipd"><meta property="og:type" content="article"><meta property="og:title" content="windows10 WSL setup"><meta property="og:description" content><meta property="og:image" content="/imgs/luyang_avatar.png"><meta property="og:image:width" content="312"><meta property="og:image:height" content="312"><meta property="og:image:type" content="image/jpeg/png/svg/jpg"><meta property="og:url" content="/post/windows10_wsl/"><meta property="og:site_name" content="LuyangのBlog"><meta property="og:locale" content="zh-CN"><meta property="article:author" content="Luyang"><meta property="article:published_time" content="2023-02-09 00:00:00 +0800 CST"><meta property="article:modified_time" content="2023-02-09 00:00:00 +0800 CST"><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/font-awesome/6.1.2/css/all.min.css><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/animate.css/3.1.1/animate.min.css><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/viewerjs/1.11.0/viewer.min.css><link rel=stylesheet href=/css/main.min.f472ecba1160e6845c7e411ace211fe16545c60bed8e67710ff4251070fc7e55.css><script type=text/javascript>(function(){localDB={set:function(e,t,n){if(n===0)return;const s=new Date,o=n*864e5,i={value:t,expiry:s.getTime()+o};localStorage.setItem(e,JSON.stringify(i))},get:function(e){const t=localStorage.getItem(e);if(!t)return void 0;const n=JSON.parse(t),s=new Date;return s.getTime()>n.expiry?(localStorage.removeItem(e),void 0):n.value}},theme={active:function(){const e=localDB.get("theme");if(e==null)return;theme.toggle(e),window.matchMedia("(prefers-color-scheme: dark)").addListener(function(e){theme.toggle(e.matches?"dark":"light")})},toggle:function(e){document.documentElement.setAttribute("data-theme",e),localDB.set("theme",e,2);const t=document.querySelector("iframe.giscus-frame");if(t){const n={setConfig:{theme:e}};t.contentWindow.postMessage({giscus:n},"https://giscus.app")}}},theme.active()})(window)</script><script class=next-config data-name=page type=application/json>{"comments":true,"isHome":false,"isPage":true,"path":"windows10_wsl","permalink":"/post/windows10_wsl/","title":"windows10 WSL setup","waline":{"js":[{"alias":"waline","alias_name":"@waline/client","file":"dist/pageview.js","name":"pageview","version":"2.13.0"},{"alias":"waline","alias_name":"@waline/client","file":"dist/comment.js","name":"comment","version":"2.13.0"}]}}</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.async=!1,e.defer=!0,document.head.appendChild(e),e.onload=function(){NexT.utils.fmtBusuanzi()}})</script><title>windows10 WSL setup - LuyangのBlog</title><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label=切换导航栏 role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title>LuyangのBlog</h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description></p></div><div class=site-nav-right><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-home hvr-icon"></i>首页</a></li><li class="menu-item menu-item-about"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-user hvr-icon"></i>关于</a></li><li class="menu-item menu-item-flinks"><a href=/flinks.html class=hvr-icon-pulse rel=section><i class="fa fa-thumbs-up hvr-icon"></i>站点示例</a></li><li class="menu-item menu-item-archives"><a href=/archives/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>归档
<span class=badge>67</span></a></li><li class="menu-item menu-item-commonweal"><a href=/404.html class=hvr-icon-pulse rel=section><i class="fa fa-heartbeat hvr-icon"></i>公益 404</a></li><li class="menu-item menu-item-search"><a role=button class="popup-trigger hvr-icon-pulse"><i class="fa fa-search fa-fw hvr-icon"></i>搜索</a></li></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon><i class="fa fa-search"></i></span><div class=search-input-container><input autocomplete=off autocapitalize=off maxlength=80 placeholder=搜索... spellcheck=false type=search class=search-input></div><span class=popup-btn-close role=button><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录</li><li class=sidebar-nav-overview>站点概览</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><nav id=TableOfContents><ul><li><ul><li><a href=#通过完成以下命令调整-wsl-2-vhd-的大小>通过完成以下命令调整 WSL 2 VHD 的大小</a></li></ul></li></ul></nav></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=Luyang src=/imgs/img-lazy-loading.gif data-src=/imgs/luyang_avatar.png><p class=site-author-name itemprop=name>Luyang</p><div class=site-description itemprop=description></div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/><span class=site-state-item-count>67</span>
<span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>11</span>
<span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>112</span>
<span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-social site-overview-item animated"><span class=links-of-social-item><a href=https://github.com/luyoungcn title="Github → https://github.com/luyoungcn" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-github fa-fw hvr-icon"></i>Github</a></span></div><div class="cc-license animated" itemprop=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh class=cc-opacity rel=noopener target=_blank title=共享知识><img src=/imgs/img-lazy-loading.gif data-src=/imgs/cc/big/by_nc_sa.svg alt=共享知识></a></div><div class="links-of-blogroll site-overview-item animated"><div class=links-of-blogroll-title><i class="fa fa-globe fa-fw"></i>友情链接</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=https://home.cnblogs.com/u/liuqiongcn/ title=https://home.cnblogs.com/u/liuqiongcn/ target=_blank>一条名叫西西的狗</a></li><li class=links-of-blogroll-item><a href=https://lisenhui.cn title=https://lisenhui.cn target=_blank>凡梦星尘空间站</a></li><li class=links-of-blogroll-item><a href=https://gitee.com/hugo-next/hugo-theme-next title=https://gitee.com/hugo-next/hugo-theme-next target=_blank>Hugo-NexT</a></li></ul></div></div></div></div><div id=siteinfo-card-widget class=sidebar-card-widget><div class=item-headline><i class="fas fa-chart-line"></i>
<span>网站资讯</span></div><div class=siteinfo><div class=siteinfo-item><div class=item-name><i class="fa-solid fa-calendar-check"></i>已运行：</div><div class=item-count id=runTimes data-publishdate=0001-01-01T00:00:00+00:00></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-user"></i>总访客数：</div><div class=item-count id=busuanzi_value_site_uv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-eye"></i>页面浏览：</div><div class=item-count id=busuanzi_value_site_pv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-font"></i>总字数：</div><div class=item-count id=wordsCount data-count=50376></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-mug-hot"></i>阅读约：</div><div class=item-count id=readTimes data-times=137></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-clock-rotate-left"></i>最后更新于：</div><div class=item-count id=last-push-date data-lastpushdate=2024-01-01T20:19:08+08:00></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=tool-buttons><div id=goto-comments class="button goto-comments" title=直达评论><i class="fas fa-comments"></i></div><div id=goto-gtranslate class=button title=多语言翻译><i class="fas fa-globe"></i></div><div id=toggle-theme class=button title=深浅模式切换><i class="fas fa-adjust"></i></div><div class=back-to-top role=button title=返回顶部><i class="fa fa-arrow-up"></i>
<span>0%</span></div></div><div class=reading-progress-bar></div><a role=button class="book-mark-link book-mark-link-fixed"></a><a href=https://github.com/hugo-next rel="noopener external nofollow noreferrer" target=_blank title="Follow me on GitHub" class="exturl github-corner"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg>
</a><script type=text/javascript src=//sidecar.gitter.im/dist/sidecar.v1.js async></script><script type=text/javascript>((window.gitter={}).chat={}).options={room:"hugo-next/community"}</script><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=/post/windows10_wsl/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/imgs/luyang_avatar.png"><meta itemprop=name content="Luyang"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="Luyang"><meta itemprop=description content></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="windows10 WSL setup"><meta itemprop=description content="win10 安装 wsl2


    安装 WSL | Microsoft Docs
    

必须运行 Windows 10 版本 2004 及更高版本（内部版本 19041 及更高版本）或 Windows 11。
→ 我的电脑win10已经更新到最新，应该没问题。"></span><header class=post-header><h1 class=post-title itemprop="name headline">windows10 WSL setup
<a href=https://github.com/user-name/repo-name/tree/branch-name/subdirectory-name/post/windows10_wsl.md rel="noopener external nofollow noreferrer" target=_blank class="exturl post-edit-link" title=编辑><i class="fa fa-pen-nib"></i></a></h1><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-calendar"></i>
</span><span class=post-meta-item-text>发表于：</span>
<time title="发表于：2023-02-09 00:00:00 +0800 CST" itemprop="dateCreated datePublished" datetime="2023-02-09 00:00:00 +0800 CST">2023-02-09</time>
</span><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-folder-open"></i>
</span><span class=post-meta-item-text>分类于：</span>
<span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/%E5%B7%A5%E5%85%B7 itemprop=url rel=index><span itemprop=name>工具</span></a></span></span></div><div class=post-meta-items><span class=post-meta-item title=字数><span class=post-meta-item-icon><i class="far fa-file-word"></i>
</span><span class=post-meta-item-text>字数：</span><span>3285</span>
</span><span class=post-meta-item title=阅读><span class=post-meta-item-icon><i class="far fa-clock"></i>
</span><span class=post-meta-item-text>阅读：&ap;</span>
<span>7分钟</span>
</span><span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="far fa-eye"></i>
</span><span class=post-meta-item-text>浏览：
</span><span id=busuanzi_value_page_pv class=waline-pageview-count data-path=/post/windows10_wsl/><i class="fa fa-sync fa-spin"></i>
</span></span><span class=post-meta-item title=评论><span class=post-meta-item-icon><i class="far fa-comments"></i>
</span><span class=post-meta-item-text>评论：
</span><span class=waline-comment-count data-path=/post/windows10_wsl/><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class="post-body autonumber" itemprop=articleBody><h1 id=win10-安装-wsl2>win10 安装 wsl2</h1><p><a href=https://docs.microsoft.com/zh-cn/windows/wsl/install title="安装 WSL | Microsoft Docs" rel="noopener external nofollow noreferrer" target=_blank class=exturl>安装 WSL | Microsoft Docs
<i class="fa fa-external-link-alt"></i></a></p><p>必须运行 Windows 10 版本 2004 及更高版本（内部版本 19041 及更高版本）或 Windows 11。</p><p>→ 我的电脑win10已经更新到最新，应该没问题。</p><p>设置→系统→关于</p><p><img src=/imgs/img-lazy-loading.gif data-src=windows10_wsl_setup_Untitled_0.png alt=Untitled></p><p>以管理员身份运行 powershell</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>wsl —install
</span></span></code></pre></div><p>如果没有安装wsl，则会进入安装过程，如果已经安装会打印帮助信息</p><p>要在安装新的 Linux 发行版时将默认版本设置为 WSL 1 或 WSL 2，请使用命令 <code>wsl --set-default-version &lt;Version#></code>，将 <code>&lt;Version#></code>替换为 1 或 2。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>wsl --set-default-version <span style=color:#ae81ff>2</span>
</span></span></code></pre></div><h1 id=wsl2-安装ubuntu-distro>wsl2 安装ubuntu distro</h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>wsl --list --online
</span></span></code></pre></div><p>以下是可安装的有效分发的列表。
请使用“wsl &ndash;install -d &lt;分发>”安装。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>NAME            FRIENDLY NAME
</span></span><span style=display:flex><span>Ubuntu          Ubuntu
</span></span><span style=display:flex><span>Debian          Debian GNU/Linux
</span></span><span style=display:flex><span>kali-linux      Kali Linux Rolling
</span></span><span style=display:flex><span>openSUSE-42     openSUSE Leap <span style=color:#ae81ff>42</span>
</span></span><span style=display:flex><span>SLES-12         SUSE Linux Enterprise Server v12
</span></span><span style=display:flex><span>Ubuntu-16.04    Ubuntu 16.04 LTS
</span></span><span style=display:flex><span>Ubuntu-18.04    Ubuntu 18.04 LTS
</span></span><span style=display:flex><span>Ubuntu-20.04    Ubuntu 20.04 LTS
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>wsl --install -d Ubuntu-20.04
</span></span></code></pre></div><h1 id=卸载-wsl2-distro>卸载 wsl2 distro</h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>wsl -l -v
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>wsl --unregister Debian
</span></span></code></pre></div><p>限制vmmem进程内存占用过高</p><p>%UserProfile% 目录下新建 .wslconfig , 内容如下</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>wsl2<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>memory<span style=color:#f92672>=</span>2GB
</span></span></code></pre></div><h1 id=access-wsl2ubuntu-drive-from-file-explorer>Access WSL2/Ubuntu Drive from File Explorer</h1><ol><li>Open File Explorer</li><li>Type <code>\\wsl$</code> in the address bar</li><li>My distro shows up and click on it and you can see the file system.</li></ol><h1 id=mount-a-linux-filesystem-disk-in-wsl2>Mount a Linux filesystem disk in WSL2</h1><ol><li><p>win usbipd .exe</p></li><li><p>下载wsl2内核源码，开启USB Mass Storage 编译安装</p></li><li><p>wsl2</p><ol><li><a href=https://github.com/dorssel/usbipd-win/wiki/WSL-support#usbip-client-tools title=https://github.com/dorssel/usbipd-win/wiki/WSL-support#usbip-client-tools rel="noopener external nofollow noreferrer" target=_blank class=exturl>https://github.com/dorssel/usbipd-win/wiki/WSL-support#usbip-client-tools
<i class="fa fa-external-link-alt"></i></a></li><li><a href=https://docs.microsoft.com/zh-tw/windows/wsl/connect-usb title=https://docs.microsoft.com/zh-tw/windows/wsl/connect-usb rel="noopener external nofollow noreferrer" target=_blank class=exturl>https://docs.microsoft.com/zh-tw/windows/wsl/connect-usb
<i class="fa fa-external-link-alt"></i></a></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt install linux-tools-virtual hwdata
</span></span><span style=display:flex><span>sudo update-alternatives --install /usr/local/bin/usbip usbip /usr/lib/linux-tools/*/usbip <span style=color:#ae81ff>20</span>
</span></span></code></pre></div></li><li><p>OK</p></li></ol><p><strong><a href=https://dowww.spencerwoo.com/4-advanced/4-4-usb.html#usbip-win title="让 WSL 2 支持 USB WSL 2" rel="noopener external nofollow noreferrer" target=_blank class=exturl>让 WSL 2 支持 USB WSL 2
<i class="fa fa-external-link-alt"></i>
</a></strong>connect a USB device</p><ul><li><strong><a href=https://docs.microsoft.com/en-us/windows/wsl/connect-usb title="Connect USB devices" rel="noopener external nofollow noreferrer" target=_blank class=exturl>Connect USB devices
<i class="fa fa-external-link-alt"></i></a></strong></li><li>USB/IP open-source project
<a href=https://github.com/dorssel/usbipd-win title=uspipd-win rel="noopener external nofollow noreferrer" target=_blank class=exturl>uspipd-win
<i class="fa fa-external-link-alt"></i>
</a>is needed<ul><li>Once the USB/IP project has completed installing, you will need to install the user space tools and a database of USB hardware identifiers. These instructions are for Ubuntu — 
<a href=https://github.com/dorssel/usbipd-win/wiki/WSL-support#usbip-client-tools title="other distributions may require a different usbip client package" rel="noopener external nofollow noreferrer" target=_blank class=exturl>other distributions may require a different usbip client package
<i class="fa fa-external-link-alt"></i>
</a>.</li></ul></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt install linux-tools-5.4.0-77-generic hwdata
</span></span><span style=display:flex><span>sudo update-alternatives --install /usr/local/bin/usbip usbip /usr/lib/linux-tools/5.4.0-77-generic/usbip <span style=color:#ae81ff>20</span>
</span></span></code></pre></div><p>Running Linux kernel 5.10.60.1 or higher</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>luyang@DESKTOP-DM1TKNP:~/WSL2-Linux-Kernel-linux-msft-wsl-5.10.102.1$ uname -a
</span></span><span style=display:flex><span>Linux DESKTOP-DM1TKNP 5.10.16.3-microsoft-standard-WSL2 <span style=color:#75715e>#1 SMP Fri Apr 2 22:23:49 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux</span>
</span></span></code></pre></div><p>It has recently become <strong>simpler to update the WSL 2 Kernel: turn on &ldquo;Receive updates for other Microsoft products when you update Windows&rdquo;</strong> in the Advanced options for Windows update. The WSL2 kernel will get updated automatically.</p><p>以管理员身份运行 powershell</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>PS C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\s</span>ystem32&gt; wsl --update
</span></span><span style=display:flex><span>正在检查更新...
</span></span><span style=display:flex><span>正在下载更新...
</span></span><span style=display:flex><span>正在安装更新...
</span></span><span style=display:flex><span>此更改将在 WSL 下次完全重启时生效。若要强制重启，请运行“wsl --shutdown”。
</span></span><span style=display:flex><span>内核版本： 5.10.102.1
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>luyang@DESKTOP-DM1TKNP:/mnt/c/Users/luyang$ uname -a
</span></span><span style=display:flex><span>Linux DESKTOP-DM1TKNP 5.10.102.1-microsoft-standard-WSL2 <span style=color:#75715e>#1 SMP Wed Mar 2 00:30:59 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux</span>
</span></span></code></pre></div><p>identify the disk and partition to attach to WSL2</p><ul><li><p>Before attaching your USB device, ensure that a WSL command line is open. This will keep the WSL 2 lightweight VM active.</p></li><li><p>List all of the USB devices connected to Windows by opening PowerShell in <em>administrator</em>  mode and entering the command: <code>usbipd wsl list</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>PS C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\s</span>ystem32&gt; usbipd wsl list
</span></span><span style=display:flex><span>BUSID  DEVICE                                                        STATE
</span></span><span style=display:flex><span>1-2    HP HD Camera                                                  Not attached
</span></span><span style=display:flex><span>1-7    Synaptics FS7604 Touch Fingerprint Sensor with PurePrint<span style=color:#f92672>(</span>TM<span style=color:#f92672>)</span>  Not attached
</span></span><span style=display:flex><span>1-10   英特尔<span style=color:#f92672>(</span>R<span style=color:#f92672>)</span> 无线 Bluetooth<span style=color:#f92672>(</span>R<span style=color:#f92672>)</span>                                   Not attached
</span></span><span style=display:flex><span>1-13   USB Attached SCSI <span style=color:#f92672>(</span>UAS<span style=color:#f92672>)</span> 大容量存储设备                        Not attached
</span></span><span style=display:flex><span>1-14   USB Attached SCSI <span style=color:#f92672>(</span>UAS<span style=color:#f92672>)</span> 大容量存储设备                        Not attached
</span></span></code></pre></div></li></ul><p>Select the bus ID of the device you’d like to attach to WSL and run this command. You’ll be prompted by WSL for a password to run a sudo command. The Linux distribution to be attached must be your default distribution. (See the 
<a href=https://docs.microsoft.com/en-us/windows/wsl/basic-commands#set-default-linux-distribution title="Basic comands for WSL" rel="noopener external nofollow noreferrer" target=_blank class=exturl>Basic comands for WSL
<i class="fa fa-external-link-alt"></i>
</a>doc to change your default distribution). <code>usbipd wsl attach --busid &lt;busid></code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>PS C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\s</span>ystem32&gt; usbipd wsl attach --busid 1-13
</span></span><span style=display:flex><span>PS C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\s</span>ystem32&gt;
</span></span></code></pre></div><p>Open Ubuntu (or your preferred WSL command line) and list the attached USB devices using the command: <code>lsusb</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>luyang@DESKTOP-DM1TKNP:/mnt/c/Users/luyang$ lsusb
</span></span><span style=display:flex><span>Bus <span style=color:#ae81ff>002</span> Device 002: ID 1058:25f3 Western Digital Technologies, Inc. 
</span></span><span style=display:flex><span>Bus <span style=color:#ae81ff>002</span> Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hub      
</span></span><span style=display:flex><span>Bus <span style=color:#ae81ff>001</span> Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
</span></span></code></pre></div><p>You should see the device you just attached and be able to interact with it using normal Linux tools. Depending on your application, you may need to configure udev rules to allow non-root users to access the device.</p><p>Once you are done using the device in WSL, you can either physically disconnect the USB device or run this command from PowerShell in <em>administrator</em> mode: <code>usbipd wsl detach --busid &lt;busid></code></p><p>mount</p><ul><li>按照上边的流程，usb设备已经挂载到了wsl2 ubuntu子系统，剩下的就是常规的ubuntu操作了</li><li>sudo lsusb 可以显示usb设备，但是sudo fdisk -l不显示usb设备， lsblk 也不显示移动硬盘的分区</li><li>[https://www.youtube.com/watch?v=iyBfQXmyH4o](
<a href="https://www.youtube.com/watch?v=iyBfQXmyH4o" title="https://www.youtube.com/watch?v=iyBfQXmyH4o" rel="noopener external nofollow noreferrer" target=_blank class=exturl>https://www.youtube.com/watch?v=iyBfQXmyH4o
<i class="fa fa-external-link-alt"></i></a></li><li><a href=https://github.com/microsoft/WSL/issues/7770 title=https://github.com/microsoft/WSL/issues/7770 rel="noopener external nofollow noreferrer" target=_blank class=exturl>https://github.com/microsoft/WSL/issues/7770
<i class="fa fa-external-link-alt"></i></a></li><li><a href=https://github.com/microsoft/WSL2-Linux-Kernel/blob/918dbaa9fa4aa665c9e5fe44489dd453da7cadeb/Microsoft/config-wsl#L2374-L2380 title=https://github.com/microsoft/WSL2-Linux-Kernel/blob/918dbaa9fa4aa665c9e5fe44489dd453da7cadeb/Microsoft/config-wsl#L2374-L2380 rel="noopener external nofollow noreferrer" target=_blank class=exturl>https://github.com/microsoft/WSL2-Linux-Kernel/blob/918dbaa9fa4aa665c9e5fe44489dd453da7cadeb/Microsoft/config-wsl#L2374-L2380
<i class="fa fa-external-link-alt"></i></a></li><li>手动编译内核</li><li>下载
<a href=https://docs.microsoft.com/en-us/windows/wsl/kernel-release-notes title=源码 rel="noopener external nofollow noreferrer" target=_blank class=exturl>源码
<i class="fa fa-external-link-alt"></i></a></li><li><code>sudo apt install build-essential flex bison libssl-dev libelf-dev libncurses-dev autoconf libudev-dev libtool</code></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>cd WSL2-Linux-Kernel-linux-msft-wsl-5.10.102.1
</span></span><span style=display:flex><span>luyang@DESKTOP-DM1TKNP:~/WSL2-Linux-Kernel-linux-msft-wsl-5.10.102.1$ cp /proc/config.gz config.gz
</span></span><span style=display:flex><span>luyang@DESKTOP-DM1TKNP:~/WSL2-Linux-Kernel-linux-msft-wsl-5.10.102.1$ gunzip config.gz
</span></span><span style=display:flex><span>luyang@DESKTOP-DM1TKNP:~/WSL2-Linux-Kernel-linux-msft-wsl-5.10.102.1$ cp config .config
</span></span><span style=display:flex><span>luyang@DESKTOP-DM1TKNP:~/WSL2-Linux-Kernel-linux-msft-wsl-5.10.102.1$ make menuconfig
</span></span><span style=display:flex><span><span style=color:#75715e># Device Drivers -&gt; USB support -&gt; select USB Mass Storage support and Enter y -&gt; save and exit</span>
</span></span><span style=display:flex><span>luyang@DESKTOP-DM1TKNP:~/WSL2-Linux-Kernel-linux-msft-wsl-5.10.102.1$ make -j8
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 编译过程中报错, 根据报错直接vim .config 注释掉了 CONFIG_DEBUG_INFO_BTF 项，保存然后再次make -j8</span>
</span></span><span style=display:flex><span><span style=color:#75715e># CONFIG_DEBUG_INFO_BTF is not set</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>luyang@DESKTOP-DM1TKNP:~/WSL2-Linux-Kernel-linux-msft-wsl-5.10.102.1$ sudo make modules_install -j8
</span></span><span style=display:flex><span>luyang@DESKTOP-DM1TKNP:~/WSL2-Linux-Kernel-linux-msft-wsl-5.10.102.1$ sudo make install -j8
</span></span><span style=display:flex><span>luyang@DESKTOP-DM1TKNP:~/WSL2-Linux-Kernel-linux-msft-wsl-5.10.102.1$ cp vmlinux /mnt/c/Users/luyang/
</span></span></code></pre></div><p>powershell terminal</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>wsl --shutdown
</span></span></code></pre></div><p>修改 Windows 下的 <code>c/User/&lt;username>/.wslconfig</code>，没有该文件自己创建一个，内容如下：主要是kernel这一项</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>wsl2<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>kernel<span style=color:#f92672>=</span>C:<span style=color:#ae81ff>\\</span>Users<span style=color:#ae81ff>\\</span>luyang<span style=color:#ae81ff>\\</span>vmlinux
</span></span><span style=display:flex><span>memory<span style=color:#f92672>=</span>2GB
</span></span></code></pre></div><p>restart wsl, 然后按照前边attash usb的方式挂载之后</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>luyang@DESKTOP-DM1TKNP:~/WSL2-Linux-Kernel-linux-msft-wsl-5.10.102.1$ lsusb
</span></span><span style=display:flex><span>Bus <span style=color:#ae81ff>002</span> Device 002: ID 1058:25f3 Western Digital Technologies, Inc. 
</span></span><span style=display:flex><span>Bus <span style=color:#ae81ff>002</span> Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hub      
</span></span><span style=display:flex><span>Bus <span style=color:#ae81ff>001</span> Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub      
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># sdc 就是我要挂载的移动硬盘</span>
</span></span><span style=display:flex><span>luyang@DESKTOP-DM1TKNP:~/WSL2-Linux-Kernel-linux-msft-wsl-5.10.102.1$ lsblk
</span></span><span style=display:flex><span>NAME   MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT
</span></span><span style=display:flex><span>sda      8:0    <span style=color:#ae81ff>0</span>   256G  <span style=color:#ae81ff>0</span> disk
</span></span><span style=display:flex><span>sdb      8:16   <span style=color:#ae81ff>0</span>   256G  <span style=color:#ae81ff>0</span> disk /
</span></span><span style=display:flex><span>sdc      8:32   <span style=color:#ae81ff>0</span> 476.9G  <span style=color:#ae81ff>0</span> disk
</span></span><span style=display:flex><span>├─sdc1   8:33   <span style=color:#ae81ff>0</span>   512M  <span style=color:#ae81ff>0</span> part
</span></span><span style=display:flex><span>├─sdc2   8:34   <span style=color:#ae81ff>0</span>    50G  <span style=color:#ae81ff>0</span> part
</span></span><span style=display:flex><span>└─sdc3   8:35   <span style=color:#ae81ff>0</span> 426.4G  <span style=color:#ae81ff>0</span> part
</span></span></code></pre></div><h1 id=扩展-wsl-2-虚拟硬盘的大小><strong>扩展 WSL 2 虚拟硬盘的大小</strong></h1><ul><li><a href=https://docs.microsoft.com/zh-cn/windows/wsl/vhd-size title=https://docs.microsoft.com/zh-cn/windows/wsl/vhd-size rel="noopener external nofollow noreferrer" target=_blank class=exturl>https://docs.microsoft.com/zh-cn/windows/wsl/vhd-size
<i class="fa fa-external-link-alt"></i></a></li><li>wsl —shutdown</li><li>查找发行版安装包名称<ul><li><code>Get-AppxPackage -Name "*&lt;distro>*" | Select PackageFamilyName</code></li><li>例如：<code>Get-AppxPackage -Name "*Ubuntu*" | Select PackageFamilyName</code></li><li><img src=/imgs/img-lazy-loading.gif data-src=windows10_wsl_setup_Untitled_1.png alt=Untitled></li></ul></li><li>使用生成的 <code>PackageFamilyName</code> 查找 WSL 2 安装使用的 VHD 文件 <code>fullpath</code>，这将是你的 <code>pathToVHD</code>。 若要查找完整路径：<ul><li>在“开始”菜单中，输入“%LOCALAPPDATA%”并选择打开 %LOCALAPPDATA% 文件文件夹。</li><li>接下来，打开“Packages”文件夹并搜索分发版的 <code>PackageFamilyName</code>。 打开该文件夹（即 CanonicalGroupLimited.Ubuntu20.04onWindows_79xxxxx）。</li><li>在 <code>PackageFamilyName</code> 文件夹中，打开“LocalState”文件夹并找到 <code>&lt;disk>.vhdx</code> 文件。</li><li>复制该文件的路劲个，它应如下所示：<code>%LOCALAPPDATA%\Packages\&lt;PackageFamilyName>\LocalState\&lt;disk>.vhdx</code></li><li>例如，Ubuntu 20.04 的 <code>&lt;pathToVHD></code> 应如下所示：<code>%LOCALAPPDATA%\Packages\CanonicalGroupLimited.Ubuntu20.04onWindows_79xxxx\LocalState\ext4.vhdx</code></li></ul></li></ul><h3 id=通过完成以下命令调整-wsl-2-vhd-的大小>通过完成以下命令调整 WSL 2 VHD 的大小</h3><p>以管理员权限打开 Windows 命令提示，然后输入：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>diskpart
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>DISKPART&gt; Select vdisk file=&#34;&lt;pathToVHD&gt;&#34;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>DISKPART&gt; detail vdisk
</span></span></code></pre></div><p>检查 detail 命令的输出。 输出将包含虚拟大小的值。 这是当前的最大值。 将此值转换为兆字节。 如果如果“详细信息”输出显示“虚拟大小: 256 GB”，请将此转换为 256000 。</p><p>你输入的新值必须大于此原始值。 例如，若要将上述虚拟大小翻倍，可输入值 512000。 确定要为新大小（以 MB 为单位）设置的数字后，在 Windows 命令提示符 diskpart 提示中输入以下命令：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>DISKPART&gt; expand vdisk maximum=&lt;sizeInMegaBytes&gt;
</span></span></code></pre></div><p>Exit diskpart</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>DISKPART&gt; exit
</span></span></code></pre></div><p>启动 WSL 发行版（例如 Ubuntu），确保它在 WSL 2 中运行（不支持 WSL 1）。 可以使用以下命令确认这一点：<code>wsl.exe -l -v</code>。</p><p>通过从 WSL 分发版命令行运行以下命令，让 WSL 知道它可扩展其文件系统的大小。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>sudo mount -t devtmpfs none /dev
</span></span><span style=display:flex><span>mount | grep ext4
</span></span></code></pre></div><p>可能会看到以下消息，它响应第一个 mount 命令：“/dev: /dev 上未装载任何内容。”可以放心地忽略此消息。</p><p>复制此项的名称，该名称类似于：<code>/dev/sdX</code>（X 表示任何其他字符）。 在下面的示例中，X 的值是 b：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>sudo resize2fs /dev/sdb &lt;sizeInMegabytes&gt;M
</span></span></code></pre></div><p>在上述示例中，我们将 vhd 大小更改为了 512000，因此命令将为 <code>sudo resize2fs /dev/sdb 512000M</code>。</p><p><strong>备注</strong></p><p>可能需要安装 resize2fs。 如果是这样，可以使用此命令进行安装：<code>sudo apt install resize2fs</code>。</p><p>输出将类似于以下内容：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>resize2fs 1.44.1 (24-Mar-2021)
</span></span><span style=display:flex><span>Filesystem at /dev/sdb is mounted on /; on-line resizing required
</span></span><span style=display:flex><span>old_desc_blocks = 32, new_desc_blocks = 38
</span></span><span style=display:flex><span>The filesystem on /dev/sdb is now 78643200 (4k) blocks long.
</span></span></code></pre></div><p><strong>重要</strong></p><p>建议不要使用 Windows 工具或编辑器来修改、移动或访问 AppData 文件夹中与 WSL 相关的文件。 这样做可能会导致 Linux 分发版损坏。 如果要从 Windows 访问 Linux 文件，可通过路径 <code>\\wsl$\&lt;distroName>\</code> 进行访问。 打开 WSL 分发版，然后输入 <code>explorer.exe .</code> 来查看此文件夹。 若要了解详细信息，请查看博客文章：<strong>
<a href=https://devblogs.microsoft.com/commandline/whats-new-for-wsl-in-windows-10-version-1903/#accessing-linux-files-from-windows title="从 Windows 访问 Linux 文件" rel="noopener external nofollow noreferrer" target=_blank class=exturl>从 Windows 访问 Linux 文件
<i class="fa fa-external-link-alt"></i>
</a></strong>。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>DISKPART&gt; expand vdisk maximum<span style=color:#f92672>=</span><span style=color:#ae81ff>512000</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>虚拟磁盘服务错误:
</span></span><span style=display:flex><span>连接虚拟磁盘时，无法执行请求的操作。
</span></span></code></pre></div><p><img src=/imgs/img-lazy-loading.gif data-src=windows10_wsl_setup_Untitled_2.png alt=Untitled></p><p>管理员权限运行 powershell</p><p><img src=/imgs/img-lazy-loading.gif data-src=windows10_wsl_setup_Untitled_3.png alt=Untitled></p><p><img src=/imgs/img-lazy-loading.gif data-src=windows10_wsl_setup_Untitled_4.png alt=Untitled></p><h1 id=wsl2-error-0x80370114>WSL2 Error: 0x80370114</h1><p><a href=https://blog.csdn.net/m0_57298796/article/details/128395860 title="WIN11按照官方文档安装WSL2时出现error 0x80370114_半路杀出来的小黑同学的博客-CSDN博客" rel="noopener external nofollow noreferrer" target=_blank class=exturl>WIN11按照官方文档安装WSL2时出现error 0x80370114_半路杀出来的小黑同学的博客-CSDN博客
<i class="fa fa-external-link-alt"></i></a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>PS C:<span style=color:#ae81ff>\U</span>sers<span style=color:#ae81ff>\l</span>uyang&gt; wsl --install -d Ubuntu-20.04
</span></span><span style=display:flex><span>Ubuntu 20.04 LTS is already installed.
</span></span><span style=display:flex><span>Launching Ubuntu 20.04 LTS...
</span></span><span style=display:flex><span>Installing, this may take a few minutes...
</span></span><span style=display:flex><span>WslRegisterDistribution failed with error: 0x80370114
</span></span><span style=display:flex><span>Error: 0x80370114 The operation could not be started because a required feature is not installed.
</span></span></code></pre></div><p>Windows 11 上打开“设置”->“应用”->“可选功能”</p><p>“更多windows功能”选项</p><p>将“适用于Linux的Windows子系统”打勾后，重启即可。</p><h1 id=win11-默认支持直接挂载-ext4>win11 默认支持直接挂载 ext4</h1><p>根据文档，用户需要安装 Windows 11 Build 22000 版本及以上，就可以直接挂载 EXT4 等格式的 Linux 磁盘。</p><p><a href=https://learn.microsoft.com/zh-cn/windows/wsl/wsl2-mount-disk title="关于在 WSL 2 中安装 Linux 磁盘的入门 | Microsoft Learn" rel="noopener external nofollow noreferrer" target=_blank class=exturl>关于在 WSL 2 中安装 Linux 磁盘的入门 | Microsoft Learn
<i class="fa fa-external-link-alt"></i></a></p><p><strong>标识磁盘</strong></p><p>要列出 Windows 中的可用磁盘，请运行：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>GET-CimInstance -query <span style=color:#e6db74>&#34;SELECT * from Win32_DiskDrive&#34;</span>
</span></span></code></pre></div><p>磁盘路径位于“DeviceID”列下。 通常采用 \.\PHYSICALDRIVE* 格式。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>PS C:<span style=color:#ae81ff>\U</span>sers<span style=color:#ae81ff>\l</span>uyang&gt; GET-CimInstance -query <span style=color:#e6db74>&#34;SELECT * from Win32_DiskDrive&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>DeviceID           Caption              Partitions Size          Model
</span></span><span style=display:flex><span>--------           -------              ---------- ----          -----
</span></span><span style=display:flex><span><span style=color:#ae81ff>\\</span>.<span style=color:#ae81ff>\P</span>HYSICALDRIVE2 WD Green SN350 1TB   <span style=color:#ae81ff>1</span>          <span style=color:#ae81ff>1000202273280</span> WD Green SN350 1TB
</span></span><span style=display:flex><span><span style=color:#ae81ff>\\</span>.<span style=color:#ae81ff>\P</span>HYSICALDRIVE1 WDC WD40EJRX-89AKWY0 <span style=color:#ae81ff>1</span>          <span style=color:#ae81ff>4000784417280</span> WDC WD40EJRX-89AKWY0
</span></span><span style=display:flex><span><span style=color:#ae81ff>\\</span>.<span style=color:#ae81ff>\P</span>HYSICALDRIVE0 WDC WD10EZEX-08WN4A0 <span style=color:#ae81ff>3</span>          <span style=color:#ae81ff>1000202273280</span> WDC WD10EZEX-08WN4A0
</span></span></code></pre></div><p><strong>装载磁盘</strong></p><p>使用 PowerShell，可以使用上面发现的磁盘路径装载磁盘，请运行：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>wsl --mount &lt;DiskPath&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># --bare: </span>
</span></span><span style=display:flex><span>wsl --mount &lt;DiskPath&gt; --bare
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>wsl --help
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># mount 相关</span>
</span></span><span style=display:flex><span>--mount &lt;Disk&gt;
</span></span><span style=display:flex><span>	在所有 WSL <span style=color:#ae81ff>2</span> 分发中附加并安装物理或虚拟磁盘。
</span></span><span style=display:flex><span>	选项:
</span></span><span style=display:flex><span>		--vhd
</span></span><span style=display:flex><span>			指定 &lt;Disk&gt; 是指虚拟硬盘。
</span></span><span style=display:flex><span>		--bare
</span></span><span style=display:flex><span>			将磁盘附加到 WSL 2，但不进行安装。
</span></span><span style=display:flex><span>		--name &lt;Name&gt;
</span></span><span style=display:flex><span>			对安装点使用自定义名称安装磁盘。
</span></span><span style=display:flex><span>		--type &lt;Type&gt;
</span></span><span style=display:flex><span>			安装磁盘时要使用的文件系统，如果未指定，则默认为 ext4。
</span></span><span style=display:flex><span>		--options &lt;Options&gt;
</span></span><span style=display:flex><span>			其他安装选项。
</span></span><span style=display:flex><span>		--partition &lt;Index&gt;
</span></span><span style=display:flex><span>			要安装的分区索引，如果未指定，则默认为整个磁盘。
</span></span></code></pre></div><p>实际挂载 LUSK 加密的 WD 移动硬盘 - 需要管理员权限启动终端</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>PS C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\s</span>ystem32&gt; GET-CimInstance -query <span style=color:#e6db74>&#34;SELECT * from Win32_DiskDrive&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>DeviceID           Caption                              Partitions Size          Model
</span></span><span style=display:flex><span>--------           -------                              ---------- ----          -----
</span></span><span style=display:flex><span><span style=color:#ae81ff>\\</span>.<span style=color:#ae81ff>\P</span>HYSICALDRIVE2 WD Green SN350 1TB                   <span style=color:#ae81ff>1</span>          <span style=color:#ae81ff>1000202273280</span> WD Green SN350 1TB
</span></span><span style=display:flex><span><span style=color:#ae81ff>\\</span>.<span style=color:#ae81ff>\P</span>HYSICALDRIVE1 WDC WD40EJRX-89AKWY0                 <span style=color:#ae81ff>1</span>          <span style=color:#ae81ff>4000784417280</span> WDC WD40EJRX-89AKWY0
</span></span><span style=display:flex><span><span style=color:#ae81ff>\\</span>.<span style=color:#ae81ff>\P</span>HYSICALDRIVE0 WDC WD10EZEX-08WN4A0                 <span style=color:#ae81ff>3</span>          <span style=color:#ae81ff>1000202273280</span> WDC WD10EZEX-08WN4A0
</span></span><span style=display:flex><span><span style=color:#ae81ff>\\</span>.<span style=color:#ae81ff>\P</span>HYSICALDRIVE3 WD My Passport 25F3 SCSI Disk Device <span style=color:#ae81ff>1</span>          <span style=color:#ae81ff>512073031680</span>  WD My Passport 25F3 SCSI Disk Device
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PS C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\s</span>ystem32&gt; wsl --mount <span style=color:#ae81ff>\\</span>.<span style=color:#ae81ff>\P</span>HYSICALDRIVE3 --bare
</span></span><span style=display:flex><span>操作成功完成。
</span></span></code></pre></div><p>之后通过 WSL ubuntu terminal 操作, 查看对应设备</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>sudo fdisk -l
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Device     Boot Start        End    Sectors   Size Id Type
</span></span><span style=display:flex><span>/dev/sdc1        <span style=color:#ae81ff>2048</span> <span style=color:#ae81ff>1000148991</span> <span style=color:#ae81ff>1000146944</span> 476.9G <span style=color:#ae81ff>83</span> Linux
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>sudo cryptsetup luksOpen /dev/sdc1 wd
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sudo mount /dev/mapper/wd ~/wd_udisk
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sudo umount ~/wd_udisk
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sudo cryptsetup luksClose wd
</span></span></code></pre></div><p>挂载机械硬盘</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># window terminal 管理员权限</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 1T</span>
</span></span><span style=display:flex><span>wsl --mount <span style=color:#ae81ff>\\</span>.<span style=color:#ae81ff>\P</span>HYSICALDRIVE0 --bare
</span></span><span style=display:flex><span><span style=color:#75715e># 4T</span>
</span></span><span style=display:flex><span>wsl --mount <span style=color:#ae81ff>\\</span>.<span style=color:#ae81ff>\P</span>HYSICALDRIVE1 --bare
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># ubuntu terminal</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 4T</span>
</span></span><span style=display:flex><span>sudo mount -t ext4 /dev/sdf1 ~/HD_4T
</span></span></code></pre></div></div><footer class=post-footer><div class=post-tags><a href=/tags/windows>windows
</a><a href=/tags/wsl>wsl
</a><a href=/tags/linux>linux
</a><a href=/tags/ext4>ext4
</a><a href=/tags/usbipd>usbipd</a></div><div class=addthis_inline_share_toolbox style=text-align:center></div><hr><div class=reward-container><div><i class="fa-solid fa-mug-hot"></i>请我喝杯咖啡吧 ヾ(^▽^*)))</div><button>赞赏</button><div class=post-reward><div class=post-reward-item><img src=/imgs/img-lazy-loading.gif data-src=/imgs/ali-pay.png alt="Luyang - 支付宝">
<span>支付宝</span></div><div class=post-reward-item><img src=/imgs/img-lazy-loading.gif data-src=/imgs/wechat-pay.png alt="Luyang - 微信">
<span>微信</span></div></div></div><div class=post-copyright><img src=/imgs/cc/cc.svg width=75 height=75 align=right><ul><li class=post-copyright-title><strong>文章标题：</strong>
windows10 WSL setup</li><li class=post-copyright-author><strong>本文作者： </strong>Luyang</li><li class=post-copyright-link><strong>本文链接：</strong>
<a id=post-cr-link href=/post/windows10_wsl/ title="windows10 WSL setup">/post/windows10_wsl/</a></li><li class=post-copyright-license><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <i class="fab fa-fw fa-creative-commons"></i><a target=_blank href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class=followme><span>欢迎关注我的其它发布渠道</span><div class=social-list><div class=social-item><a target=_blank class=social-link href=/images/wechat_channel.jpg><span class=icon><i class="fab fa-weixin"></i>
</span><span class=label>WeChat</span></a></div><div class=social-item><a target=_blank class=social-link href=/atom.xml><span class=icon><i class="fa fa-rss"></i>
</span><span class=label>RSS</span></a></div></div></div><div class=post-nav><div class="post-nav-next post-nav-item"><a href=/post/linux_date_cmd/ rel=next title="Linux date 命令用法"><i class="fa fa-chevron-left"></i> Linux date 命令用法</a></div><div class="post-nav-prev post-nav-item"><a href=/post/%E9%BB%91%E8%8A%9D%E9%BA%BB%E5%B9%B3%E5%8F%B0%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91-openssl/ rel=prev title="黑芝麻平台交叉编译 openssl">黑芝麻平台交叉编译 openssl
<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div id=comments class=post-comments><div class=comment-head><div class=comment-headline><i class="fas fa-comments fa-fw"></i>
<span>评论交流</span></div></div><div class=comment-wrap><div><div class=comment-loading><i class="fa fa-sync fa-spin"></i></div><div class=giscus-container></div></div></div></div></div></main><footer class=footer><div class=footer-inner><div id=gtranslate class=google-translate><i class="fa fa-language"></i><div id=google_translate_element></div></div><div class=copyright>&copy;
<span itemprop=copyrightYear>2010 - 2025
</span><span class=with-love><i class="fa fa-heart"></i>
</span><span class=author itemprop=copyrightHolder>Luyang</span></div><div class=powered-by>由 <a href=https://gohugo.io title=0.143.1 target=_blank>Hugo</a> & <a href=https://github.com/hugo-next/hugo-theme-next title=4.4.1 target=_blank>Hugo NexT.Gemini</a> 强力驱动</div><div class=beian><a href=https://beian.miit.gov.cn target=_blank>粤ICP备 18047355-1 号</a>
<img src=/imgs/gongan.png alt=沪公网安备>
<a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=31011402009770" target=_blank>沪公网安备 31011402009770 号</a></div><div class=vendors-list><a target=_blank href=https://vercel.com title=Vercel><img src=/imgs/img-lazy-loading.gif data-src=/imgs/vendors/vercel.svg alt=Vercel>
</a><a target=_blank href=https://upyun.com title=又拍云><img src=/imgs/img-lazy-loading.gif data-src=/imgs/vendors/upyun.png alt=又拍云>
</a><a target=_blank href=https://webify.cloudbase.net title=Webify>Webify
</a><span>提供CDN/云资源支持</span></div></div></footer><script type=text/javascript src=https://cdn.staticfile.org/animejs/3.2.1/anime.min.js defer></script><script type=text/javascript src=https://cdn.staticfile.org/viewerjs/1.11.0/viewer.min.js defer></script><script class=next-config data-name=main type=application/json>{"bookmark":{"color":"#222","enable":true,"save":"manual"},"busuanzi":{"pageview":true},"copybtn":true,"darkmode":true,"giscus":{"cfg":{"category":"General","categoryid":"DIC_kwDOJzMFzM4CXbDz","emit":false,"inputposition":"top","mapping":"pathname","reactions":true,"repo":"luyoungcn/luyoungcn.giscus","repoid":"R_kgDOJzMFzA","theme":"dark"},"js":"https://giscus.app/client.js"},"hostname":"/","i18n":{"ds_day":" 天前","ds_days":" 天 ","ds_hour":" 小时前","ds_hours":" 小时 ","ds_just":"刚刚","ds_min":" 分钟前","ds_mins":" 分钟","ds_month":" 个月前","ds_years":" 年 ","empty":"没有找到任何搜索结果：${query}","hits":"","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","placeholder":"搜索..."},"lang":"zh-CN","lazyload":false,"localSearch":{"enable":true,"path":"/searchindexes.xml","preload":false,"topnperarticle":-1,"trigger":"auto","unescape":false},"motion":{"async":true,"enable":true,"transition":{"collheader":"fadeInLeft","postblock":"fadeIn","postbody":"fadeInDown","postheader":"fadeInDown","sidebar":"fadeInUp"}},"root":"/","scheme":"Gemini","sidebar":{"display":"post","offset":12,"padding":18,"position":"left","width":256},"statis":{"enable":true,"plugin":"busuanzi"},"vendor":{"plugins":"qiniu","router":"https://cdn.staticfile.org"},"version":"4.4.1","waline":{"cfg":{"comment":true,"emoji":false,"imguploader":false,"pageview":true,"placeholder":"请文明发言哟 ヾ(≧▽≦*)o","reaction":true,"reactiontext":["点赞","踩一下","得意","不屑","尴尬","睡觉"],"reactiontitle":"你认为这篇文章怎么样？","requiredmeta":["nick","mail"],"serverurl":null,"sofa":"快来发表你的意见吧 (≧∀≦)ゞ","wordlimit":200},"css":{"alias":"waline","file":"dist/waline.css","name":"@waline/client","version":"2.13.0"},"js":{"alias":"waline","file":"dist/waline.js","name":"@waline/client","version":"2.13.0"}}}</script><script type=text/javascript src=/js/main.min.37028fbafbd97fd89808b4c7b5a3a81f01ed0ab24001d273d774f9546a0e9170.js defer></script></body></html>