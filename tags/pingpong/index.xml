<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Pingpong on Luyangã®Blog</title>
    <link>/tags/pingpong/</link>
    <description>Recent content in Pingpong on Luyangã®Blog</description>
    <generator>Hugo</generator>
    <language>en-US</language>
    <lastBuildDate>Wed, 04 Jun 2025 02:30:00 +0800</lastBuildDate>
    <atom:link href="/tags/pingpong/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>ğŸ“˜ PingPong Buffer è®¾è®¡æ–‡æ¡£</title>
      <link>/posts/-pingpong-buffer-%E8%AE%BE%E8%AE%A1%E6%96%87%E6%A1%A3/</link>
      <pubDate>Wed, 04 Jun 2025 02:30:00 +0800</pubDate>
      <guid>/posts/-pingpong-buffer-%E8%AE%BE%E8%AE%A1%E6%96%87%E6%A1%A3/</guid>
      <description>&lt;h1 id=&#34;-pingpong-buffer-è®¾è®¡æ–‡æ¡£&#34;&gt;ğŸ“˜ PingPong Buffer è®¾è®¡æ–‡æ¡£&lt;/h1&gt;&#xA;&lt;h2 id=&#34;ä¸€è®¾è®¡ç›®æ ‡&#34;&gt;ä¸€ã€è®¾è®¡ç›®æ ‡&lt;/h2&gt;&#xA;&lt;p&gt;PingPongBufferï¼ˆåŒç¼“å†²åŒºï¼‰æ—¨åœ¨è§£å†³ç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…å¼‚æ­¥å¤„ç†æ•°æ®æ—¶çš„æ•°æ®ä¸€è‡´æ€§ä¸æ€§èƒ½é—®é¢˜ã€‚é€‚ç”¨äº&lt;strong&gt;å®æ—¶æ•°æ®ä¼ è¾“&lt;/strong&gt;ã€&lt;strong&gt;ä¸­æ–­é‡‡é›†&lt;/strong&gt;ã€&lt;strong&gt;å¤šçº¿ç¨‹é€šä¿¡&lt;/strong&gt;ç­‰åœºæ™¯ï¼Œå…·å¤‡å¦‚ä¸‹æ ¸å¿ƒç›®æ ‡ï¼š&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;ä¿è¯&lt;strong&gt;è¯»å†™äº’ä¸å¹²æ‰°&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;æ”¯æŒ&lt;strong&gt;é«˜ååã€ä½å»¶è¿Ÿ&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;èƒ½å¤Ÿåº”å¯¹&lt;strong&gt;é€Ÿç‡ä¸åŒ¹é…&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;å¯ç»´æŠ¤ã€å¯è°ƒè¯•ã€å¯æ‰©å±•&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;hr&gt;&#xA;&lt;h2 id=&#34;äºŒæ ¸å¿ƒè®¾è®¡ç†å¿µ&#34;&gt;äºŒã€æ ¸å¿ƒè®¾è®¡ç†å¿µ&lt;/h2&gt;&#xA;&lt;h3 id=&#34;21-åŒç¼“å†²ç»“æ„&#34;&gt;2.1 åŒç¼“å†²ç»“æ„&lt;/h3&gt;&#xA;&lt;p&gt;ä½¿ç”¨ä¸¤ä¸ªå›ºå®šå¤§å°çš„ç¼“å†²åŒº &lt;code&gt;buffer[0]&lt;/code&gt; å’Œ &lt;code&gt;buffer[1]&lt;/code&gt;ï¼Œé€šè¿‡ç´¢å¼•æˆ–æ ‡å¿—ä½æ§åˆ¶è¯»å†™æŒ‡å‘ä¸åŒç¼“å†²åŒºã€‚&lt;/p&gt;&#xA;&lt;table&gt;&#xA;  &lt;thead&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;th&gt;Buffer Index&lt;/th&gt;&#xA;          &lt;th&gt;ç”¨é€”&lt;/th&gt;&#xA;      &lt;/tr&gt;&#xA;  &lt;/thead&gt;&#xA;  &lt;tbody&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;&lt;code&gt;write_idx&lt;/code&gt;&lt;/td&gt;&#xA;          &lt;td&gt;å½“å‰å†™å…¥ç¼“å†²åŒºç´¢å¼•&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;&lt;code&gt;read_idx&lt;/code&gt;&lt;/td&gt;&#xA;          &lt;td&gt;å½“å‰è¯»å–ç¼“å†²åŒºç´¢å¼•&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;  &lt;/tbody&gt;&#xA;&lt;/table&gt;&#xA;&lt;p&gt;é€šè¿‡åŸå­æ“ä½œï¼ˆæˆ–é”ï¼‰åˆ‡æ¢è¿™ä¸¤ä¸ªç¼“å†²åŒºï¼Œå®ç°æ— é”æˆ–ä½é”ç«äº‰çš„æ•°æ®äº¤æ›¿ä½¿ç”¨ã€‚&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;h3 id=&#34;22-åŸå­åˆ‡æ¢æœºåˆ¶&#34;&gt;2.2 åŸå­åˆ‡æ¢æœºåˆ¶&lt;/h3&gt;&#xA;&lt;p&gt;é‡‡ç”¨ &lt;code&gt;std::atomic&amp;lt;int&amp;gt;&lt;/code&gt; ç´¢å¼•å˜é‡é…åˆ &lt;code&gt;memory_order_release/acquire&lt;/code&gt; ä¿è¯è·¨çº¿ç¨‹æˆ–ä¸­æ–­çš„æ•°æ®å¯è§æ€§ä¸ä¸€è‡´æ€§ã€‚&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;write_idx.store(new_index, std&lt;span style=&#34;color:#f92672&#34;&gt;::&lt;/span&gt;memory_order_release);&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;read_idx.store(old_write_index, std&lt;span style=&#34;color:#f92672&#34;&gt;::&lt;/span&gt;memory_order_acquire);&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;&#xA;&lt;h3 id=&#34;23-æ•°æ®å®Œæ•´æ€§æ§åˆ¶&#34;&gt;2.3 æ•°æ®å®Œæ•´æ€§æ§åˆ¶&lt;/h3&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;ä½¿ç”¨ &lt;code&gt;BeginWrite/EndWrite&lt;/code&gt; å’Œ &lt;code&gt;BeginRead/EndRead&lt;/code&gt; ä¿éšœå¸§çº§æ•°æ®å®Œæ•´æ€§&lt;/li&gt;&#xA;&lt;li&gt;ä½¿ç”¨ &lt;code&gt;frame_valid&lt;/code&gt; æ ‡å¿—ä½æ ‡è¯† buffer æ˜¯å¦å†™æ»¡å¯è¯»&lt;/li&gt;&#xA;&lt;li&gt;æ”¯æŒ &lt;code&gt;frame_id&lt;/code&gt;ã€æ—¶é—´æˆ³ç­‰é™„åŠ ä¿¡æ¯è¿½è¸ªæ•°æ®æ¥æºåŠä¸€è‡´æ€§&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;hr&gt;&#xA;&lt;h2 id=&#34;ä¸‰å¼‚å¸¸ä¸è¿‡è½½å¤„ç†æœºåˆ¶&#34;&gt;ä¸‰ã€å¼‚å¸¸ä¸è¿‡è½½å¤„ç†æœºåˆ¶&lt;/h2&gt;&#xA;&lt;h3 id=&#34;31-ç”Ÿäº§è€…å¿«äºæ¶ˆè´¹è€…overrun&#34;&gt;3.1 ç”Ÿäº§è€…å¿«äºæ¶ˆè´¹è€…ï¼ˆoverrunï¼‰&lt;/h3&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;å½“å‰å†™ buffer flip åï¼Œè‹¥æ—§ buffer å°šæœªæ¶ˆè´¹ â†’ è®°å½•è¦†ç›–è¡Œä¸º&lt;/li&gt;&#xA;&lt;li&gt;å¼•å…¥ &lt;code&gt;overrun_counter&lt;/code&gt;ï¼Œå¹¶æä¾›å¼‚å¸¸æç¤ºæ¥å£&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;buffer_valid[read_idx]) {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    overrun_counter&lt;span style=&#34;color:#f92672&#34;&gt;++&lt;/span&gt;;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;32-å¼‚å¸¸å¸§æ£€æµ‹&#34;&gt;3.2 å¼‚å¸¸å¸§æ£€æµ‹&lt;/h3&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;frame_id&lt;/code&gt; ä¸è¿ç»­æ—¶æç¤ºä¸¢å¸§&lt;/li&gt;&#xA;&lt;li&gt;æ—¶é—´æˆ³å·®è·è¿‡å¤§å¯è®¤ä¸ºæ•°æ®é˜»å¡&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;hr&gt;&#xA;&lt;h2 id=&#34;å››çŠ¶æ€é‡ç½®ä¸é…ç½®å˜æ›´&#34;&gt;å››ã€çŠ¶æ€é‡ç½®ä¸é…ç½®å˜æ›´&lt;/h2&gt;&#xA;&lt;p&gt;æ”¯æŒ &lt;code&gt;reset()&lt;/code&gt; æ“ä½œï¼Œåœ¨åº•å±‚ç¡¬ä»¶é‡é…ç½®ï¼ˆå¦‚åˆ†è¾¨ç‡ã€é¢‘ç‡ï¼‰æˆ–ç³»ç»Ÿçƒ­åˆ‡æ¢åœºæ™¯ä¸­æ¸…ç©ºç¼“å†²çŠ¶æ€ï¼Œé˜²æ­¢æ—§æ•°æ®å¹²æ‰°ï¼š&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
