<!DOCTYPE html>
<html lang="en" style="font-size: 100%">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="author" content="">

  
  
  <meta name="description" content="win10 安装 wsl2
安装 WSL | Microsoft Docs
必须运行 Windows 10 版本 2004 及更高版本（内部版本 19041 及更高版本）或 Windows 11。
→ 我的电脑win10已经更新到最新，应该没问题。
设置→系统→关于

以管理员身份运行 powershell">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://luyoungcn.github.io//images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="https://luyoungcn.github.io//images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://luyoungcn.github.io//images/favicon-16x16.png">

  
  
  <meta name="keywords" content='hugo latex theme blog texify texify2 texify3 michael neuper'>
  

  
  
  <link rel="stylesheet" href='/katex/katex.min.css'>
<script defer defer src='/katex/katex.min.js'></script>
<script defer src='/katex/contrib/auto-render.min.js'></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
          delimiters: [
              {left: '$$', right: '$$', display: true},
              {left: '$', right: '$', display: false},
              {left: '\\(', right: '\\)', display: false},
              {left: '\\[', right: '\\]', display: true}
          ],
          throwOnError : false
        });
    });
</script>
  

  
  <script data-name="BMC-Widget" 
    data-cfasync="true" 
    src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" 
    data-id="michaelneuper" 
    data-description="Like what I do? Buy me a coffee!" 
    data-message="" 
    data-color="#d79921" 
    data-position="Right" 
    data-x_margin="18" 
    data-y_margin="18"
    crossorigin="anonymous">
</script>


  
  <meta property="og:url" content="https://luyoungcn.github.io/posts/windows10_wsl/">
  <meta property="og:site_name" content="LuyangのBlog">
  <meta property="og:title" content="windows10 WSL setup">
  <meta property="og:description" content="win10 安装 wsl2 安装 WSL | Microsoft Docs
必须运行 Windows 10 版本 2004 及更高版本（内部版本 19041 及更高版本）或 Windows 11。
→ 我的电脑win10已经更新到最新，应该没问题。
设置→系统→关于
以管理员身份运行 powershell">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-02-09T00:00:00+08:00">
    <meta property="article:modified_time" content="2023-02-09T00:00:00+08:00">
    <meta property="article:tag" content="Windows">
    <meta property="article:tag" content="Wsl">
    <meta property="article:tag" content="Linux">
    <meta property="article:tag" content="Ext4">
    <meta property="article:tag" content="Usbipd">


  
  <link rel="canonical" href="https://luyoungcn.github.io/posts/windows10_wsl/">

  
  
  
  <meta itemprop="name" content="windows10 WSL setup">
  <meta itemprop="description" content="win10 安装 wsl2 安装 WSL | Microsoft Docs
必须运行 Windows 10 版本 2004 及更高版本（内部版本 19041 及更高版本）或 Windows 11。
→ 我的电脑win10已经更新到最新，应该没问题。
设置→系统→关于
以管理员身份运行 powershell">
  <meta itemprop="datePublished" content="2023-02-09T00:00:00+08:00">
  <meta itemprop="dateModified" content="2023-02-09T00:00:00+08:00">
  <meta itemprop="wordCount" content="3283">
  <meta itemprop="keywords" content="Windows,Wsl,Linux,Ext4,Usbipd">

  
  
  
    <link rel="stylesheet" href="/css/common.min.e562d763c6d0825495eb17de8b2c1d9800cf7c08db1c36accedf77a5fccfc4b9.css" integrity="sha256-5WLXY8bQglSV6xfeiywdmADPfAjbHDaszt93pfzPxLk=" crossorigin="anonymous">
  

  
  
    <link rel="stylesheet" href="/css/content.min.ba38eba94cb47fef9936258c42d11ff19fa9686a30b38e783773fe3f15eb44dc.css" integrity="sha256-ujjrqUy0f&#43;&#43;ZNiWMQtEf8Z&#43;paGows454N3P&#43;PxXrRNw=" crossorigin="anonymous">
  

  
  
  <title>windows10 WSL setup - LuyangのBlog</title>
  

  
  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="windows10 WSL setup">
  <meta name="twitter:description" content="win10 安装 wsl2 安装 WSL | Microsoft Docs
必须运行 Windows 10 版本 2004 及更高版本（内部版本 19041 及更高版本）或 Windows 11。
→ 我的电脑win10已经更新到最新，应该没问题。
设置→系统→关于
以管理员身份运行 powershell">


  


  <link rel="stylesheet" href="/css/single.min.be779f459ad7e3aaf8afd0f80c6a61ca6c50993f5f18512532100ac6d93f0fa9.css" integrity="sha256-vnefRZrX46r4r9D4DGphymxQmT9fGFElMhAKxtk/D6k=" crossorigin="anonymous">


  <link rel="stylesheet" href="/css/single.min.78a121b7d7a160420f9daab0ea13add66c37b9c44f27bba07b27207e2b0975d2.css" integrity="sha256-eKEht9ehYEIPnaqw6hOt1mw3ucRPJ7ugeycgfisJddI=" crossorigin="anonymous">


</head>

<body>
  <div id="wrapper">
    


<header id="header">
  <h1>
    <a href="https://luyoungcn.github.io/">TeXify3</a>
    <button id="dark-mode-toggle" class="dark-mode-toggle" aria-label="Toggle theme">
        <svg width="2rem" height="2rem" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 496">
        <path fill="currentColor" d="M8,256C8,393,119,504,256,504S504,393,504,256,393,8,256,8,8,119,8,256ZM256,440V72a184,184,0,0,1,0,368Z" transform="translate(-8 -8)"/>
        </svg>
    </button>
  </h1>

  <nav>
    
    <span class="nav-bar-item">
      
        <span class="icon"><svg width="1em" height="1em" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M17,11H16a1,1,0,0,0,0,2h1a1,1,0,0,0,0-2Zm0,4H16a1,1,0,0,0,0,2h1a1,1,0,0,0,0-2ZM11,9h6a1,1,0,0,0,0-2H11a1,1,0,0,0,0,2ZM21,3H7A1,1,0,0,0,6,4V7H3A1,1,0,0,0,2,8V18a3,3,0,0,0,3,3H18a4,4,0,0,0,4-4V4A1,1,0,0,0,21,3ZM6,18a1,1,0,0,1-2,0V9H6Zm14-1a2,2,0,0,1-2,2H7.82A3,3,0,0,0,8,18V5H20Zm-9-4h1a1,1,0,0,0,0-2H11a1,1,0,0,0,0,2Zm0,4h1a1,1,0,0,0,0-2H11a1,1,0,0,0,0,2Z"/></svg>
</span>
      
      <a class="link" href="/posts/">Blog</a>
    </span>
    
    <span class="nav-bar-item">
      
        <span class="icon"><svg width="1em" height="1em" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M2.88,16.88a3,3,0,0,0,0,4.24,3,3,0,0,0,4.24,0,3,3,0,0,0-4.24-4.24Zm2.83,2.83a1,1,0,0,1-1.42-1.42,1,1,0,0,1,1.42,0A1,1,0,0,1,5.71,19.71ZM5,12a1,1,0,0,0,0,2,5,5,0,0,1,5,5,1,1,0,0,0,2,0,7,7,0,0,0-7-7ZM5,8a1,1,0,0,0,0,2,9,9,0,0,1,9,9,1,1,0,0,0,2,0,11.08,11.08,0,0,0-3.22-7.78A11.08,11.08,0,0,0,5,8Zm10.61.39A15.11,15.11,0,0,0,5,4,1,1,0,0,0,5,6,13,13,0,0,1,18,19a1,1,0,0,0,2,0A15.11,15.11,0,0,0,15.61,8.39Z"/></svg>
</span>
      
      <a class="link" href="/index.xml">RSS</a>
    </span>
    
    <span class="nav-bar-item">
      
        <span class="icon"><svg width="1em" height="1em" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" data-name="Layer 1">
<path d="M10.07031,20.50291a1.00008,1.00008,0,0,0-1.18115-.9834c-1.30908.24024-2.96191.27637-3.40137-.958a5.70754,5.70754,0,0,0-1.83691-2.415,1.20073,1.20073,0,0,1-.1665-.10938,1,1,0,0,0-.93067-.64551H2.54883a.99965.99965,0,0,0-1,.99512c-.00391.81543.811,1.33789,1.1416,1.51465a4.4408,4.4408,0,0,1,.92383,1.35937c.36426,1.02344,1.42285,2.57617,4.46582,2.376.001.03516.00195.06836.00244.09863l.00439.26758a1,1,0,0,0,2,0l-.00488-.31836C10.07715,21.4951,10.07031,21.22068,10.07031,20.50291Zm10.667-15.126c.03174-.125.063-.26367.09034-.41992a6.27792,6.27792,0,0,0-.40821-3.293,1.002,1.002,0,0,0-.61572-.58007c-.356-.12012-1.67041-.35645-4.18408,1.25a13.86918,13.86918,0,0,0-6.354,0C6.76221.751,5.45459.9658,5.10205,1.07908a.99744.99744,0,0,0-.63135.584,6.3003,6.3003,0,0,0-.40332,3.35644c.02442.12793.05078.2461.07813.35449A6.26928,6.26928,0,0,0,2.89014,9.20311a8.42168,8.42168,0,0,0,.04248.92187c.334,4.60254,3.334,5.98438,5.42431,6.459-.04345.125-.083.25878-.11816.40039a1.00023,1.00023,0,0,0,1.94238.47851,1.6784,1.6784,0,0,1,.46778-.87793.99947.99947,0,0,0-.5459-1.74512c-3.4541-.39453-4.95362-1.80175-5.1792-4.89843a6.61076,6.61076,0,0,1-.03369-.73828,4.25769,4.25769,0,0,1,.91943-2.71289,3.022,3.022,0,0,1,.1958-.23145.99988.99988,0,0,0,.188-1.02441,3.3876,3.3876,0,0,1-.15527-.55567A4.09356,4.09356,0,0,1,6.1167,3.06346a7.54263,7.54263,0,0,1,2.415,1.17968,1.00877,1.00877,0,0,0,.82764.13282,11.77716,11.77716,0,0,1,6.17285.001,1.00549,1.00549,0,0,0,.83056-.13769,7.572,7.572,0,0,1,2.40528-1.19043,4.03977,4.03977,0,0,1,.0874,1.57812,3.205,3.205,0,0,1-.16895.60743.9999.9999,0,0,0,.188,1.02441c.07715.08691.1543.18066.22363.26855A4.12186,4.12186,0,0,1,20,9.20311a7.03888,7.03888,0,0,1-.0376.77734c-.22021,3.05566-1.72558,4.46387-5.1958,4.85937a1,1,0,0,0-.54541,1.7461,1.63079,1.63079,0,0,1,.46631.9082,3.06079,3.06079,0,0,1,.09229.81934v2.334C14.77,21.2949,14.77,21.78025,14.77,22.00291a1,1,0,1,0,2,0c0-.2168,0-.69238.00977-1.33984V18.31346a4.8815,4.8815,0,0,0-.15479-1.31153,4.25638,4.25638,0,0,0-.11621-.416,6.51258,6.51258,0,0,0,5.44531-6.42383A8.69677,8.69677,0,0,0,22,9.20311,6.13062,6.13062,0,0,0,20.7373,5.37693Z"/></svg>
</span>
      
      <a class="link" href="https://github.com/luyoungcn">GitHub</a>
    </span>
    
  </nav>
</header>
<hr class="head-rule"></hr>
    
<main id="main" class="post">
  
  <div class="post-heading">
    <h1 class="post-title">windows10 WSL setup</h1>
    <div class="publish-metadata">
      
      <svg width="0.75em" height="0.75em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M3 9H21M7 3V5M17 3V5M6 13H8M6 17H8M11 13H13M11 17H13M16 13H18M16 17H18M6.2 21H17.8C18.9201 21 19.4802 21 19.908 20.782C20.2843 20.5903 20.5903 20.2843 20.782 19.908C21 19.4802 21 18.9201 21 17.8V8.2C21 7.07989 21 6.51984 20.782 6.09202C20.5903 5.71569 20.2843 5.40973 19.908 5.21799C19.4802 5 18.9201 5 17.8 5H6.2C5.0799 5 4.51984 5 4.09202 5.21799C3.71569 5.40973 3.40973 5.71569 3.21799 6.09202C3 6.51984 3 7.07989 3 8.2V17.8C3 18.9201 3 19.4802 3.21799 19.908C3.40973 20.2843 3.71569 20.5903 4.09202 20.782C4.51984 21 5.07989 21 6.2 21Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      9 February 2023
      
      
        &nbsp;
        <span>
          <svg width="0.75em" height="0.75em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M15.4998 5.49994L18.3282 8.32837M3 20.9997L3.04745 20.6675C3.21536 19.4922 3.29932 18.9045 3.49029 18.3558C3.65975 17.8689 3.89124 17.4059 4.17906 16.9783C4.50341 16.4963 4.92319 16.0765 5.76274 15.237L17.4107 3.58896C18.1918 2.80791 19.4581 2.80791 20.2392 3.58896C21.0202 4.37001 21.0202 5.63634 20.2392 6.41739L8.37744 18.2791C7.61579 19.0408 7.23497 19.4216 6.8012 19.7244C6.41618 19.9932 6.00093 20.2159 5.56398 20.3879C5.07171 20.5817 4.54375 20.6882 3.48793 20.9012L3 20.9997Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          3283 words
        </span>
      
      
      
        
      
      
        &nbsp;
        <span>
          <svg width="0.75em" height="0.75em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 7V12L14.5 13.5M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          ~7 mins
        </span>
      
    </div>
  </div>

  
  <div>
    
    <a class="link tag" href='https://luyoungcn.github.io/tags/windows'>#windows</a>
    
    <a class="link tag" href='https://luyoungcn.github.io/tags/wsl'>#wsl</a>
    
    <a class="link tag" href='https://luyoungcn.github.io/tags/linux'>#linux</a>
    
    <a class="link tag" href='https://luyoungcn.github.io/tags/ext4'>#ext4</a>
    
    <a class="link tag" href='https://luyoungcn.github.io/tags/usbipd'>#usbipd</a>
    
    <br></br>
  </div>
  
  
  
  <details>
    <summary>
      <b>Table of Contents</b>
    </summary>
    <div class="toc numbered-subtitles"><nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#通过完成以下命令调整-wsl-2-vhd-的大小">通过完成以下命令调整 WSL 2 VHD 的大小</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
  </details>
  
  
  <article class="content numbered-subtitles">
    
    <h1 id="win10-安装-wsl2">win10 安装 wsl2</h1>
<p><a href="https://docs.microsoft.com/zh-cn/windows/wsl/install">安装 WSL | Microsoft Docs</a></p>
<p>必须运行 Windows 10 版本 2004 及更高版本（内部版本 19041 及更高版本）或 Windows 11。</p>
<p>→ 我的电脑win10已经更新到最新，应该没问题。</p>
<p>设置→系统→关于</p>
<p><img src="windows10_wsl_setup_Untitled_0.png" alt="Untitled"></p>
<p>以管理员身份运行 powershell</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">wsl —install
</span></span></code></pre></div><p>如果没有安装wsl，则会进入安装过程，如果已经安装会打印帮助信息</p>
<p>要在安装新的 Linux 发行版时将默认版本设置为 WSL 1 或 WSL 2，请使用命令 <code>wsl --set-default-version &lt;Version#&gt;</code>，将 <code>&lt;Version#&gt;</code>替换为 1 或 2。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">wsl --set-default-version <span class="m">2</span>
</span></span></code></pre></div><h1 id="wsl2-安装ubuntu-distro">wsl2 安装ubuntu distro</h1>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">wsl --list --online
</span></span></code></pre></div><p>以下是可安装的有效分发的列表。
请使用“wsl &ndash;install -d &lt;分发&gt;”安装。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">NAME            FRIENDLY NAME
</span></span><span class="line"><span class="cl">Ubuntu          Ubuntu
</span></span><span class="line"><span class="cl">Debian          Debian GNU/Linux
</span></span><span class="line"><span class="cl">kali-linux      Kali Linux Rolling
</span></span><span class="line"><span class="cl">openSUSE-42     openSUSE Leap <span class="m">42</span>
</span></span><span class="line"><span class="cl">SLES-12         SUSE Linux Enterprise Server v12
</span></span><span class="line"><span class="cl">Ubuntu-16.04    Ubuntu 16.04 LTS
</span></span><span class="line"><span class="cl">Ubuntu-18.04    Ubuntu 18.04 LTS
</span></span><span class="line"><span class="cl">Ubuntu-20.04    Ubuntu 20.04 LTS
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">wsl --install -d Ubuntu-20.04
</span></span></code></pre></div><h1 id="卸载-wsl2-distro">卸载 wsl2 distro</h1>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">wsl -l -v
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">wsl --unregister Debian
</span></span></code></pre></div><p>限制vmmem进程内存占用过高</p>
<p>%UserProfile% 目录下新建 .wslconfig , 内容如下</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>wsl2<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nv">memory</span><span class="o">=</span>2GB
</span></span></code></pre></div><h1 id="access-wsl2ubuntu-drive-from-file-explorer">Access WSL2/Ubuntu Drive from File Explorer</h1>
<ol>
<li>Open File Explorer</li>
<li>Type <code>\\wsl$</code> in the address bar</li>
<li>My distro shows up and click on it and you can see the file system.</li>
</ol>
<h1 id="mount-a-linux-filesystem-disk-in-wsl2">Mount a Linux filesystem disk in WSL2</h1>
<ol>
<li>
<p>win usbipd .exe</p>
</li>
<li>
<p>下载wsl2内核源码，开启USB Mass Storage 编译安装</p>
</li>
<li>
<p>wsl2</p>
<ol>
<li><a href="https://github.com/dorssel/usbipd-win/wiki/WSL-support#usbip-client-tools">https://github.com/dorssel/usbipd-win/wiki/WSL-support#usbip-client-tools</a></li>
<li><a href="https://docs.microsoft.com/zh-tw/windows/wsl/connect-usb">https://docs.microsoft.com/zh-tw/windows/wsl/connect-usb</a></li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo apt install linux-tools-virtual hwdata
</span></span><span class="line"><span class="cl">sudo update-alternatives --install /usr/local/bin/usbip usbip /usr/lib/linux-tools/*/usbip <span class="m">20</span>
</span></span></code></pre></div></li>
<li>
<p>OK</p>
</li>
</ol>
<p><strong><a href="https://dowww.spencerwoo.com/4-advanced/4-4-usb.html#usbip-win">让 WSL 2 支持 USB WSL 2</a></strong>
connect a USB device</p>
<ul>
<li><strong><a href="https://docs.microsoft.com/en-us/windows/wsl/connect-usb">Connect USB devices</a></strong></li>
<li>USB/IP open-source project <a href="https://github.com/dorssel/usbipd-win">uspipd-win</a> is needed
<ul>
<li>Once the USB/IP project has completed installing, you will need to install the user space tools and a database of USB hardware identifiers. These instructions are for Ubuntu — <a href="https://github.com/dorssel/usbipd-win/wiki/WSL-support#usbip-client-tools">other distributions may require a different usbip client package</a>.</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo apt install linux-tools-5.4.0-77-generic hwdata
</span></span><span class="line"><span class="cl">sudo update-alternatives --install /usr/local/bin/usbip usbip /usr/lib/linux-tools/5.4.0-77-generic/usbip <span class="m">20</span>
</span></span></code></pre></div><p>Running Linux kernel 5.10.60.1 or higher</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">luyang@DESKTOP-DM1TKNP:~/WSL2-Linux-Kernel-linux-msft-wsl-5.10.102.1$ uname -a
</span></span><span class="line"><span class="cl">Linux DESKTOP-DM1TKNP 5.10.16.3-microsoft-standard-WSL2 <span class="c1">#1 SMP Fri Apr 2 22:23:49 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux</span>
</span></span></code></pre></div><p>It has recently become <strong>simpler to update the WSL 2 Kernel: turn on &ldquo;Receive updates for other Microsoft products when you update Windows&rdquo;</strong> in the Advanced options for Windows update. The WSL2 kernel will get updated automatically.</p>
<p>以管理员身份运行 powershell</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">PS C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32&gt; wsl --update
</span></span><span class="line"><span class="cl">正在检查更新...
</span></span><span class="line"><span class="cl">正在下载更新...
</span></span><span class="line"><span class="cl">正在安装更新...
</span></span><span class="line"><span class="cl">此更改将在 WSL 下次完全重启时生效。若要强制重启，请运行“wsl --shutdown”。
</span></span><span class="line"><span class="cl">内核版本： 5.10.102.1
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">luyang@DESKTOP-DM1TKNP:/mnt/c/Users/luyang$ uname -a
</span></span><span class="line"><span class="cl">Linux DESKTOP-DM1TKNP 5.10.102.1-microsoft-standard-WSL2 <span class="c1">#1 SMP Wed Mar 2 00:30:59 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux</span>
</span></span></code></pre></div><p>identify the disk and partition to attach to WSL2</p>
<ul>
<li>
<p>Before attaching your USB device, ensure that a WSL command line is open. This will keep the WSL 2 lightweight VM active.</p>
</li>
<li>
<p>List all of the USB devices connected to Windows by opening PowerShell in <em>administrator</em>     mode and entering the command: <code>usbipd wsl list</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">PS C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32&gt; usbipd wsl list
</span></span><span class="line"><span class="cl">BUSID  DEVICE                                                        STATE
</span></span><span class="line"><span class="cl">1-2    HP HD Camera                                                  Not attached
</span></span><span class="line"><span class="cl">1-7    Synaptics FS7604 Touch Fingerprint Sensor with PurePrint<span class="o">(</span>TM<span class="o">)</span>  Not attached
</span></span><span class="line"><span class="cl">1-10   英特尔<span class="o">(</span>R<span class="o">)</span> 无线 Bluetooth<span class="o">(</span>R<span class="o">)</span>                                   Not attached
</span></span><span class="line"><span class="cl">1-13   USB Attached SCSI <span class="o">(</span>UAS<span class="o">)</span> 大容量存储设备                        Not attached
</span></span><span class="line"><span class="cl">1-14   USB Attached SCSI <span class="o">(</span>UAS<span class="o">)</span> 大容量存储设备                        Not attached
</span></span></code></pre></div></li>
</ul>
<p>Select the bus ID of the device you’d like to attach to WSL and run this command. You’ll be prompted by WSL for a password to run a sudo command. The Linux distribution to be attached must be your default distribution. (See the <a href="https://docs.microsoft.com/en-us/windows/wsl/basic-commands#set-default-linux-distribution">Basic comands for WSL</a> doc to change your default distribution). <code>usbipd wsl attach --busid &lt;busid&gt;</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">PS C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32&gt; usbipd wsl attach --busid 1-13
</span></span><span class="line"><span class="cl">PS C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32&gt;
</span></span></code></pre></div><p>Open Ubuntu (or your preferred WSL command line) and list the attached USB devices using the command: <code>lsusb</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">luyang@DESKTOP-DM1TKNP:/mnt/c/Users/luyang$ lsusb
</span></span><span class="line"><span class="cl">Bus <span class="m">002</span> Device 002: ID 1058:25f3 Western Digital Technologies, Inc. 
</span></span><span class="line"><span class="cl">Bus <span class="m">002</span> Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hub      
</span></span><span class="line"><span class="cl">Bus <span class="m">001</span> Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
</span></span></code></pre></div><p>You should see the device you just attached and be able to interact with it using normal Linux tools. Depending on your application, you may need to configure udev rules to allow non-root users to access the device.</p>
<p>Once you are done using the device in WSL, you can either physically disconnect the USB device or run this command from PowerShell in <em>administrator</em> mode: <code>usbipd wsl detach --busid &lt;busid&gt;</code></p>
<p>mount</p>
<ul>
<li>按照上边的流程，usb设备已经挂载到了wsl2 ubuntu子系统，剩下的就是常规的ubuntu操作了</li>
<li>sudo lsusb 可以显示usb设备，但是sudo fdisk -l不显示usb设备， lsblk 也不显示移动硬盘的分区</li>
<li>[https://www.youtube.com/watch?v=iyBfQXmyH4o](<a href="https://www.youtube.com/watch?v=iyBfQXmyH4o">https://www.youtube.com/watch?v=iyBfQXmyH4o</a></li>
<li><a href="https://github.com/microsoft/WSL/issues/7770">https://github.com/microsoft/WSL/issues/7770</a></li>
<li><a href="https://github.com/microsoft/WSL2-Linux-Kernel/blob/918dbaa9fa4aa665c9e5fe44489dd453da7cadeb/Microsoft/config-wsl#L2374-L2380">https://github.com/microsoft/WSL2-Linux-Kernel/blob/918dbaa9fa4aa665c9e5fe44489dd453da7cadeb/Microsoft/config-wsl#L2374-L2380</a></li>
<li>手动编译内核</li>
<li>下载<a href="https://docs.microsoft.com/en-us/windows/wsl/kernel-release-notes">源码</a></li>
<li><code>sudo apt install build-essential flex bison libssl-dev libelf-dev libncurses-dev autoconf libudev-dev libtool</code></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> WSL2-Linux-Kernel-linux-msft-wsl-5.10.102.1
</span></span><span class="line"><span class="cl">luyang@DESKTOP-DM1TKNP:~/WSL2-Linux-Kernel-linux-msft-wsl-5.10.102.1$ cp /proc/config.gz config.gz
</span></span><span class="line"><span class="cl">luyang@DESKTOP-DM1TKNP:~/WSL2-Linux-Kernel-linux-msft-wsl-5.10.102.1$ gunzip config.gz
</span></span><span class="line"><span class="cl">luyang@DESKTOP-DM1TKNP:~/WSL2-Linux-Kernel-linux-msft-wsl-5.10.102.1$ cp config .config
</span></span><span class="line"><span class="cl">luyang@DESKTOP-DM1TKNP:~/WSL2-Linux-Kernel-linux-msft-wsl-5.10.102.1$ make menuconfig
</span></span><span class="line"><span class="cl"><span class="c1"># Device Drivers -&gt; USB support -&gt; select USB Mass Storage support and Enter y -&gt; save and exit</span>
</span></span><span class="line"><span class="cl">luyang@DESKTOP-DM1TKNP:~/WSL2-Linux-Kernel-linux-msft-wsl-5.10.102.1$ make -j8
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 编译过程中报错, 根据报错直接vim .config 注释掉了 CONFIG_DEBUG_INFO_BTF 项，保存然后再次make -j8</span>
</span></span><span class="line"><span class="cl"><span class="c1"># CONFIG_DEBUG_INFO_BTF is not set</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">luyang@DESKTOP-DM1TKNP:~/WSL2-Linux-Kernel-linux-msft-wsl-5.10.102.1$ sudo make modules_install -j8
</span></span><span class="line"><span class="cl">luyang@DESKTOP-DM1TKNP:~/WSL2-Linux-Kernel-linux-msft-wsl-5.10.102.1$ sudo make install -j8
</span></span><span class="line"><span class="cl">luyang@DESKTOP-DM1TKNP:~/WSL2-Linux-Kernel-linux-msft-wsl-5.10.102.1$ cp vmlinux /mnt/c/Users/luyang/
</span></span></code></pre></div><p>powershell terminal</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">wsl --shutdown
</span></span></code></pre></div><p>修改 Windows 下的 <code>c/User/&lt;username&gt;/.wslconfig</code>，没有该文件自己创建一个，内容如下：主要是kernel这一项</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>wsl2<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nv">kernel</span><span class="o">=</span>C:<span class="se">\\</span>Users<span class="se">\\</span>luyang<span class="se">\\</span>vmlinux
</span></span><span class="line"><span class="cl"><span class="nv">memory</span><span class="o">=</span>2GB
</span></span></code></pre></div><p>restart wsl, 然后按照前边attash usb的方式挂载之后</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">luyang@DESKTOP-DM1TKNP:~/WSL2-Linux-Kernel-linux-msft-wsl-5.10.102.1$ lsusb
</span></span><span class="line"><span class="cl">Bus <span class="m">002</span> Device 002: ID 1058:25f3 Western Digital Technologies, Inc. 
</span></span><span class="line"><span class="cl">Bus <span class="m">002</span> Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hub      
</span></span><span class="line"><span class="cl">Bus <span class="m">001</span> Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub      
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># sdc 就是我要挂载的移动硬盘</span>
</span></span><span class="line"><span class="cl">luyang@DESKTOP-DM1TKNP:~/WSL2-Linux-Kernel-linux-msft-wsl-5.10.102.1$ lsblk
</span></span><span class="line"><span class="cl">NAME   MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT
</span></span><span class="line"><span class="cl">sda      8:0    <span class="m">0</span>   256G  <span class="m">0</span> disk
</span></span><span class="line"><span class="cl">sdb      8:16   <span class="m">0</span>   256G  <span class="m">0</span> disk /
</span></span><span class="line"><span class="cl">sdc      8:32   <span class="m">0</span> 476.9G  <span class="m">0</span> disk
</span></span><span class="line"><span class="cl">├─sdc1   8:33   <span class="m">0</span>   512M  <span class="m">0</span> part
</span></span><span class="line"><span class="cl">├─sdc2   8:34   <span class="m">0</span>    50G  <span class="m">0</span> part
</span></span><span class="line"><span class="cl">└─sdc3   8:35   <span class="m">0</span> 426.4G  <span class="m">0</span> part
</span></span></code></pre></div><h1 id="扩展-wsl-2-虚拟硬盘的大小"><strong>扩展 WSL 2 虚拟硬盘的大小</strong></h1>
<ul>
<li><a href="https://docs.microsoft.com/zh-cn/windows/wsl/vhd-size">https://docs.microsoft.com/zh-cn/windows/wsl/vhd-size</a></li>
<li>wsl —shutdown</li>
<li>查找发行版安装包名称
<ul>
<li><code>Get-AppxPackage -Name &quot;*&lt;distro&gt;*&quot; | Select PackageFamilyName</code></li>
<li>例如：<code>Get-AppxPackage -Name &quot;*Ubuntu*&quot; | Select PackageFamilyName</code></li>
<li><img src="windows10_wsl_setup_Untitled_1.png" alt="Untitled"></li>
</ul>
</li>
<li>使用生成的 <code>PackageFamilyName</code> 查找 WSL 2 安装使用的 VHD 文件 <code>fullpath</code>，这将是你的 <code>pathToVHD</code>。 若要查找完整路径：
<ul>
<li>在“开始”菜单中，输入“%LOCALAPPDATA%”并选择打开 %LOCALAPPDATA% 文件文件夹。</li>
<li>接下来，打开“Packages”文件夹并搜索分发版的 <code>PackageFamilyName</code>。 打开该文件夹（即 CanonicalGroupLimited.Ubuntu20.04onWindows_79xxxxx）。</li>
<li>在 <code>PackageFamilyName</code> 文件夹中，打开“LocalState”文件夹并找到 <code>&lt;disk&gt;.vhdx</code> 文件。</li>
<li>复制该文件的路劲个，它应如下所示：<code>%LOCALAPPDATA%\Packages\&lt;PackageFamilyName&gt;\LocalState\&lt;disk&gt;.vhdx</code></li>
<li>例如，Ubuntu 20.04 的 <code>&lt;pathToVHD&gt;</code> 应如下所示：<code>%LOCALAPPDATA%\Packages\CanonicalGroupLimited.Ubuntu20.04onWindows_79xxxx\LocalState\ext4.vhdx</code></li>
</ul>
</li>
</ul>
<h3 id="通过完成以下命令调整-wsl-2-vhd-的大小">通过完成以下命令调整 WSL 2 VHD 的大小</h3>
<p>以管理员权限打开 Windows 命令提示，然后输入：</p>
<div class="mermaid">diskpart
</div>

<div class="mermaid">DISKPART> Select vdisk file="<pathToVHD>"
</div>

<div class="mermaid">DISKPART> detail vdisk
</div>

<p>检查 detail 命令的输出。 输出将包含虚拟大小的值。 这是当前的最大值。 将此值转换为兆字节。 如果如果“详细信息”输出显示“虚拟大小: 256 GB”，请将此转换为 256000 。</p>
<p>你输入的新值必须大于此原始值。 例如，若要将上述虚拟大小翻倍，可输入值 512000。 确定要为新大小（以 MB 为单位）设置的数字后，在 Windows 命令提示符 diskpart 提示中输入以下命令：</p>
<div class="mermaid">DISKPART> expand vdisk maximum=<sizeInMegaBytes>
</div>

<p>Exit diskpart</p>
<div class="mermaid">DISKPART> exit
</div>

<p>启动 WSL 发行版（例如 Ubuntu），确保它在 WSL 2 中运行（不支持 WSL 1）。 可以使用以下命令确认这一点：<code>wsl.exe -l -v</code>。</p>
<p>通过从 WSL 分发版命令行运行以下命令，让 WSL 知道它可扩展其文件系统的大小。</p>
<div class="mermaid">sudo mount -t devtmpfs none /dev
mount | grep ext4
</div>

<p>可能会看到以下消息，它响应第一个 mount 命令：“/dev: /dev 上未装载任何内容。”可以放心地忽略此消息。</p>
<p>复制此项的名称，该名称类似于：<code>/dev/sdX</code>（X 表示任何其他字符）。 在下面的示例中，X 的值是 b：</p>
<div class="mermaid">sudo resize2fs /dev/sdb <sizeInMegabytes>M
</div>

<p>在上述示例中，我们将 vhd 大小更改为了 512000，因此命令将为 <code>sudo resize2fs /dev/sdb 512000M</code>。</p>
<p><strong class=chinese>备注</strong></p>
<p>可能需要安装 resize2fs。 如果是这样，可以使用此命令进行安装：<code>sudo apt install resize2fs</code>。</p>
<p>输出将类似于以下内容：</p>
<div class="mermaid">resize2fs 1.44.1 (24-Mar-2021)
Filesystem at /dev/sdb is mounted on /; on-line resizing required
old_desc_blocks = 32, new_desc_blocks = 38
The filesystem on /dev/sdb is now 78643200 (4k) blocks long.
</div>

<p><strong class=chinese>重要</strong></p>
<p>建议不要使用 Windows 工具或编辑器来修改、移动或访问 AppData 文件夹中与 WSL 相关的文件。 这样做可能会导致 Linux 分发版损坏。 如果要从 Windows 访问 Linux 文件，可通过路径 <code>\\wsl$\&lt;distroName&gt;\</code> 进行访问。 打开 WSL 分发版，然后输入 <code>explorer.exe .</code> 来查看此文件夹。 若要了解详细信息，请查看博客文章：<strong><a href="https://devblogs.microsoft.com/commandline/whats-new-for-wsl-in-windows-10-version-1903/#accessing-linux-files-from-windows">从 Windows 访问 Linux 文件</a></strong>。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">DISKPART&gt; expand vdisk <span class="nv">maximum</span><span class="o">=</span><span class="m">512000</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">虚拟磁盘服务错误:
</span></span><span class="line"><span class="cl">连接虚拟磁盘时，无法执行请求的操作。
</span></span></code></pre></div><p><img src="windows10_wsl_setup_Untitled_2.png" alt="Untitled"></p>
<p>管理员权限运行 powershell</p>
<p><img src="windows10_wsl_setup_Untitled_3.png" alt="Untitled"></p>
<p><img src="windows10_wsl_setup_Untitled_4.png" alt="Untitled"></p>
<h1 id="wsl2-error-0x80370114">WSL2 Error: 0x80370114</h1>
<p><a href="https://blog.csdn.net/m0_57298796/article/details/128395860">WIN11按照官方文档安装WSL2时出现error 0x80370114_半路杀出来的小黑同学的博客-CSDN博客</a></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">PS C:<span class="se">\U</span>sers<span class="se">\l</span>uyang&gt; wsl --install -d Ubuntu-20.04
</span></span><span class="line"><span class="cl">Ubuntu 20.04 LTS is already installed.
</span></span><span class="line"><span class="cl">Launching Ubuntu 20.04 LTS...
</span></span><span class="line"><span class="cl">Installing, this may take a few minutes...
</span></span><span class="line"><span class="cl">WslRegisterDistribution failed with error: 0x80370114
</span></span><span class="line"><span class="cl">Error: 0x80370114 The operation could not be started because a required feature is not installed.
</span></span></code></pre></div><p>Windows 11 上打开“设置”-&gt;“应用”-&gt;“可选功能”</p>
<p>“更多windows功能”选项</p>
<p>将“适用于Linux的Windows子系统”打勾后，重启即可。</p>
<h1 id="win11-默认支持直接挂载-ext4">win11 默认支持直接挂载 ext4</h1>
<p>根据文档，用户需要安装 Windows 11 Build 22000 版本及以上，就可以直接挂载 EXT4 等格式的 Linux 磁盘。</p>
<p><a href="https://learn.microsoft.com/zh-cn/windows/wsl/wsl2-mount-disk">关于在 WSL 2 中安装 Linux 磁盘的入门 | Microsoft Learn</a></p>
<p><strong class=chinese>标识磁盘</strong></p>
<p>要列出 Windows 中的可用磁盘，请运行：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">GET-CimInstance -query <span class="s2">&#34;SELECT * from Win32_DiskDrive&#34;</span>
</span></span></code></pre></div><p>磁盘路径位于“DeviceID”列下。 通常采用 \.\PHYSICALDRIVE* 格式。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">PS C:<span class="se">\U</span>sers<span class="se">\l</span>uyang&gt; GET-CimInstance -query <span class="s2">&#34;SELECT * from Win32_DiskDrive&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">DeviceID           Caption              Partitions Size          Model
</span></span><span class="line"><span class="cl">--------           -------              ---------- ----          -----
</span></span><span class="line"><span class="cl"><span class="se">\\</span>.<span class="se">\P</span>HYSICALDRIVE2 WD Green SN350 1TB   <span class="m">1</span>          <span class="m">1000202273280</span> WD Green SN350 1TB
</span></span><span class="line"><span class="cl"><span class="se">\\</span>.<span class="se">\P</span>HYSICALDRIVE1 WDC WD40EJRX-89AKWY0 <span class="m">1</span>          <span class="m">4000784417280</span> WDC WD40EJRX-89AKWY0
</span></span><span class="line"><span class="cl"><span class="se">\\</span>.<span class="se">\P</span>HYSICALDRIVE0 WDC WD10EZEX-08WN4A0 <span class="m">3</span>          <span class="m">1000202273280</span> WDC WD10EZEX-08WN4A0
</span></span></code></pre></div><p><strong class=chinese>装载磁盘</strong></p>
<p>使用 PowerShell，可以使用上面发现的磁盘路径装载磁盘，请运行：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">wsl --mount &lt;DiskPath&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># --bare: </span>
</span></span><span class="line"><span class="cl">wsl --mount &lt;DiskPath&gt; --bare
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">wsl --help
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># mount 相关</span>
</span></span><span class="line"><span class="cl">--mount &lt;Disk&gt;
</span></span><span class="line"><span class="cl">	在所有 WSL <span class="m">2</span> 分发中附加并安装物理或虚拟磁盘。
</span></span><span class="line"><span class="cl">	选项:
</span></span><span class="line"><span class="cl">		--vhd
</span></span><span class="line"><span class="cl">			指定 &lt;Disk&gt; 是指虚拟硬盘。
</span></span><span class="line"><span class="cl">		--bare
</span></span><span class="line"><span class="cl">			将磁盘附加到 WSL 2，但不进行安装。
</span></span><span class="line"><span class="cl">		--name &lt;Name&gt;
</span></span><span class="line"><span class="cl">			对安装点使用自定义名称安装磁盘。
</span></span><span class="line"><span class="cl">		--type &lt;Type&gt;
</span></span><span class="line"><span class="cl">			安装磁盘时要使用的文件系统，如果未指定，则默认为 ext4。
</span></span><span class="line"><span class="cl">		--options &lt;Options&gt;
</span></span><span class="line"><span class="cl">			其他安装选项。
</span></span><span class="line"><span class="cl">		--partition &lt;Index&gt;
</span></span><span class="line"><span class="cl">			要安装的分区索引，如果未指定，则默认为整个磁盘。
</span></span></code></pre></div><p>实际挂载 LUSK 加密的 WD 移动硬盘 - 需要管理员权限启动终端</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">PS C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32&gt; GET-CimInstance -query <span class="s2">&#34;SELECT * from Win32_DiskDrive&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">DeviceID           Caption                              Partitions Size          Model
</span></span><span class="line"><span class="cl">--------           -------                              ---------- ----          -----
</span></span><span class="line"><span class="cl"><span class="se">\\</span>.<span class="se">\P</span>HYSICALDRIVE2 WD Green SN350 1TB                   <span class="m">1</span>          <span class="m">1000202273280</span> WD Green SN350 1TB
</span></span><span class="line"><span class="cl"><span class="se">\\</span>.<span class="se">\P</span>HYSICALDRIVE1 WDC WD40EJRX-89AKWY0                 <span class="m">1</span>          <span class="m">4000784417280</span> WDC WD40EJRX-89AKWY0
</span></span><span class="line"><span class="cl"><span class="se">\\</span>.<span class="se">\P</span>HYSICALDRIVE0 WDC WD10EZEX-08WN4A0                 <span class="m">3</span>          <span class="m">1000202273280</span> WDC WD10EZEX-08WN4A0
</span></span><span class="line"><span class="cl"><span class="se">\\</span>.<span class="se">\P</span>HYSICALDRIVE3 WD My Passport 25F3 SCSI Disk Device <span class="m">1</span>          <span class="m">512073031680</span>  WD My Passport 25F3 SCSI Disk Device
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PS C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32&gt; wsl --mount <span class="se">\\</span>.<span class="se">\P</span>HYSICALDRIVE3 --bare
</span></span><span class="line"><span class="cl">操作成功完成。
</span></span></code></pre></div><p>之后通过 WSL ubuntu terminal 操作, 查看对应设备</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo fdisk -l
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Device     Boot Start        End    Sectors   Size Id Type
</span></span><span class="line"><span class="cl">/dev/sdc1        <span class="m">2048</span> <span class="m">1000148991</span> <span class="m">1000146944</span> 476.9G <span class="m">83</span> Linux
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo cryptsetup luksOpen /dev/sdc1 wd
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">sudo mount /dev/mapper/wd ~/wd_udisk
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">sudo umount ~/wd_udisk
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">sudo cryptsetup luksClose wd
</span></span></code></pre></div><p>挂载机械硬盘</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># window terminal 管理员权限</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 1T</span>
</span></span><span class="line"><span class="cl">wsl --mount <span class="se">\\</span>.<span class="se">\P</span>HYSICALDRIVE0 --bare
</span></span><span class="line"><span class="cl"><span class="c1"># 4T</span>
</span></span><span class="line"><span class="cl">wsl --mount <span class="se">\\</span>.<span class="se">\P</span>HYSICALDRIVE1 --bare
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ubuntu terminal</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 4T</span>
</span></span><span class="line"><span class="cl">sudo mount -t ext4 /dev/sdf1 ~/HD_4T
</span></span></code></pre></div>
    
  </article>

  <button onclick="topFunction()" id="back-to-top" title="Go to top">Back to Top</button>

  

<div id="sharingbuttons">
    
    
    <a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fluyoungcn.github.io%2fposts%2fwindows10_wsl%2f" target="_blank" rel="noopener" aria-label="">
      <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.77 7.46H14.5v-1.9c0-.9.6-1.1 1-1.1h3V.5h-4.33C10.24.5 9.5 3.44 9.5 5.32v2.15h-3v4h3v12h5v-12h3.85l.42-4z"/></svg>
        </div>
      </div>
    </a>
    

    
    
    <a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?text=windows10%20WSL%20setup&amp;url=https%3a%2f%2fluyoungcn.github.io%2fposts%2fwindows10_wsl%2f" target="_blank" rel="noopener" aria-label="">
      <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23.44 4.83c-.8.37-1.5.38-2.22.02.93-.56.98-.96 1.32-2.02-.88.52-1.86.9-2.9 1.1-.82-.88-2-1.43-3.3-1.43-2.5 0-4.55 2.04-4.55 4.54 0 .36.03.7.1 1.04-3.77-.2-7.12-2-9.36-4.75-.4.67-.6 1.45-.6 2.3 0 1.56.8 2.95 2 3.77-.74-.03-1.44-.23-2.05-.57v.06c0 2.2 1.56 4.03 3.64 4.44-.67.2-1.37.2-2.06.08.58 1.8 2.26 3.12 4.25 3.16C5.78 18.1 3.37 18.74 1 18.46c2 1.3 4.4 2.04 6.97 2.04 8.35 0 12.92-6.92 12.92-12.93 0-.2 0-.4-.02-.6.9-.63 1.96-1.22 2.56-2.14z"/></svg>
        </div>
      </div>
    </a>
    

    
    
    <a class="resp-sharing-button__link" href="mailto:?subject=windows10%20WSL%20setup&amp;body=https%3a%2f%2fluyoungcn.github.io%2fposts%2fwindows10_wsl%2f" target="_self" rel="noopener" aria-label="">
      <div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22 4H2C.9 4 0 4.9 0 6v12c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zM7.25 14.43l-3.5 2c-.08.05-.17.07-.25.07-.17 0-.34-.1-.43-.25-.14-.24-.06-.55.18-.68l3.5-2c.24-.14.55-.06.68.18.14.24.06.55-.18.68zm4.75.07c-.1 0-.2-.03-.27-.08l-8.5-5.5c-.23-.15-.3-.46-.15-.7.15-.22.46-.3.7-.14L12 13.4l8.23-5.32c.23-.15.54-.08.7.15.14.23.07.54-.16.7l-8.5 5.5c-.08.04-.17.07-.27.07zm8.93 1.75c-.1.16-.26.25-.43.25-.08 0-.17-.02-.25-.07l-3.5-2c-.24-.13-.32-.44-.18-.68s.44-.32.68-.18l3.5 2c.24.13.32.44.18.68z"/></svg>
        </div>
      </div>
    </a>
    

    
    
    <a class="resp-sharing-button__link" href="https://www.linkedin.com/sharing/share-offsite/?url=https%3a%2f%2fluyoungcn.github.io%2fposts%2fwindows10_wsl%2f" target="_blank" rel="noopener" aria-label="">
      <div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6.5 21.5h-5v-13h5v13zM4 6.5C2.5 6.5 1.5 5.3 1.5 4s1-2.4 2.5-2.4c1.6 0 2.5 1 2.6 2.5 0 1.4-1 2.5-2.6 2.5zm11.5 6c-1 0-2 1-2 2v7h-5v-13h5V10s1.6-1.5 4-1.5c3 0 5 2.2 5 6.3v6.7h-5v-7c0-1-1-2-2-2z"/></svg>
        </div>
      </div>
    </a>
    

    
    
    <a class="resp-sharing-button__link" href="https://reddit.com/submit/?url=https%3a%2f%2fluyoungcn.github.io%2fposts%2fwindows10_wsl%2f&amp;resubmit=true&amp;title=windows10%20WSL%20setup" target="_blank" rel="noopener" aria-label="">
      <div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M24 11.5c0-1.65-1.35-3-3-3-.96 0-1.86.48-2.42 1.24-1.64-1-3.75-1.64-6.07-1.72.08-1.1.4-3.05 1.52-3.7.72-.4 1.73-.24 3 .5C17.2 6.3 18.46 7.5 20 7.5c1.65 0 3-1.35 3-3s-1.35-3-3-3c-1.38 0-2.54.94-2.88 2.22-1.43-.72-2.64-.8-3.6-.25-1.64.94-1.95 3.47-2 4.55-2.33.08-4.45.7-6.1 1.72C4.86 8.98 3.96 8.5 3 8.5c-1.65 0-3 1.35-3 3 0 1.32.84 2.44 2.05 2.84-.03.22-.05.44-.05.66 0 3.86 4.5 7 10 7s10-3.14 10-7c0-.22-.02-.44-.05-.66 1.2-.4 2.05-1.54 2.05-2.84zM2.3 13.37C1.5 13.07 1 12.35 1 11.5c0-1.1.9-2 2-2 .64 0 1.22.32 1.6.82-1.1.85-1.92 1.9-2.3 3.05zm3.7.13c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2zm9.8 4.8c-1.08.63-2.42.96-3.8.96-1.4 0-2.74-.34-3.8-.95-.24-.13-.32-.44-.2-.68.15-.24.46-.32.7-.18 1.83 1.06 4.76 1.06 6.6 0 .23-.13.53-.05.67.2.14.23.06.54-.18.67zm.2-2.8c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm5.7-2.13c-.38-1.16-1.2-2.2-2.3-3.05.38-.5.97-.82 1.6-.82 1.1 0 2 .9 2 2 0 .84-.53 1.57-1.3 1.87z"/></svg>
        </div>
      </div>
    </a>
    

    
    
    <a class="resp-sharing-button__link" href="whatsapp://send?text=https%3a%2f%2fluyoungcn.github.io%2fposts%2fwindows10_wsl%2f" target="_blank" rel="noopener" aria-label="">
      <div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.1 3.9C17.9 1.7 15 .5 12 .5 5.8.5.7 5.6.7 11.9c0 2 .5 3.9 1.5 5.6L.6 23.4l6-1.6c1.6.9 3.5 1.3 5.4 1.3 6.3 0 11.4-5.1 11.4-11.4-.1-2.8-1.2-5.7-3.3-7.8zM12 21.4c-1.7 0-3.3-.5-4.8-1.3l-.4-.2-3.5 1 1-3.4L4 17c-1-1.5-1.4-3.2-1.4-5.1 0-5.2 4.2-9.4 9.4-9.4 2.5 0 4.9 1 6.7 2.8 1.8 1.8 2.8 4.2 2.8 6.7-.1 5.2-4.3 9.4-9.5 9.4zm5.1-7.1c-.3-.1-1.7-.9-1.9-1-.3-.1-.5-.1-.7.1-.2.3-.8 1-.9 1.1-.2.2-.3.2-.6.1s-1.2-.5-2.3-1.4c-.9-.8-1.4-1.7-1.6-2-.2-.3 0-.5.1-.6s.3-.3.4-.5c.2-.1.3-.3.4-.5.1-.2 0-.4 0-.5C10 9 9.3 7.6 9 7c-.1-.4-.4-.3-.5-.3h-.6s-.4.1-.7.3c-.3.3-1 1-1 2.4s1 2.8 1.1 3c.1.2 2 3.1 4.9 4.3.7.3 1.2.5 1.6.6.7.2 1.3.2 1.8.1.6-.1 1.7-.7 1.9-1.3.2-.7.2-1.2.2-1.3-.1-.3-.3-.4-.6-.5z"/></svg>
        </div>
      </div>
    </a>
    

    
    
    <a class="resp-sharing-button__link" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fluyoungcn.github.io%2fposts%2fwindows10_wsl%2f&amp;t=windows10%20WSL%20setup" target="_blank" rel="noopener" aria-label="">
      <div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    	<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 140 140"><path fill-rule="evenodd" d="M60.94 82.314L17 0h20.08l25.85 52.093c.397.927.86 1.888 1.39 2.883.53.994.995 2.02 1.393 3.08.265.4.463.764.596 1.095.13.334.262.63.395.898.662 1.325 1.26 2.618 1.79 3.877.53 1.26.993 2.42 1.39 3.48 1.06-2.254 2.22-4.673 3.48-7.258 1.26-2.585 2.552-5.27 3.877-8.052L103.49 0h18.69L77.84 83.308v53.087h-16.9v-54.08z"></path></svg>
        </div>
      </div>
    </a>
    

    
    
    <a class="resp-sharing-button__link" href="https://telegram.me/share/url?text=windows10%20WSL%20setup&amp;url=https%3a%2f%2fluyoungcn.github.io%2fposts%2fwindows10_wsl%2f" target="_blank" rel="noopener" aria-label="">
      <div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M.707 8.475C.275 8.64 0 9.508 0 9.508s.284.867.718 1.03l5.09 1.897 1.986 6.38a1.102 1.102 0 0 0 1.75.527l2.96-2.41a.405.405 0 0 1 .494-.013l5.34 3.87a1.1 1.1 0 0 0 1.046.135 1.1 1.1 0 0 0 .682-.803l3.91-18.795A1.102 1.102 0 0 0 22.5.075L.706 8.475z"/></svg>
        </div>
      </div>
    </a>
    
</div>
  <div class="paginator">
    
    <a class="link" href="https://luyoungcn.github.io/posts/%E9%BB%91%E8%8A%9D%E9%BA%BB%E5%B9%B3%E5%8F%B0%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91-openssl/" title="黑芝麻平台交叉编译 openssl">← prev</a>
    
    
    <a class="link" href="https://luyoungcn.github.io/posts/linux_date_cmd/" title="Linux date 命令用法">next →</a>
    
  </div>
  <div class="comment">
    
    
    
    <script src="https://giscus.app/client.js"
    data-repo="michaelneuper/website"
    data-repo-id="R_kgDOIjPNaQ"
    data-category="General"
    data-category-id="DIC_kwDOIjPNac4CaklA"
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="top"
    data-theme="gruvbox"
    data-lang="en"
    data-loading="lazy"
    crossorigin="anonymous"
    async>
</script>

  </div>
  
  
  <script type="module">
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true });
  </script>

</main>

    <footer id="footer">
  <div>
    <span>Powered by  <a class=link href=https://gohugo.io target=_blank rel=noopener>Hugo</a> | 
Theme <a class=link href=https://github.com/michaelneuper/hugo-texify3 target=_blank rel=noopener>TeXify3</a>
</span>
  </div>
  <div>
    <span>Copyright © 2025 </span>
  </div>
</footer>

  </div>

  
  <script src='https://luyoungcn.github.io/js/script.js' defer></script>

  
  

  
  

  
  

</body>

</html>
