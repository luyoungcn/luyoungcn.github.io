<!DOCTYPE html>
<html lang="en-US" dir="ltr">
<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>ğŸ“Œæ·±å…¥ç†è§£ C&#43;&#43; ä¸­çš„ std ref å’Œ cref çš„å¼•ç”¨å°è£…æœºåˆ¶ | Luyangã®Blog</title>
<link rel="icon" href="/favicon.svg" sizes="any" type="image/svg+xml" /><meta property="og:url" content="/posts/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3-c&#43;&#43;-%E4%B8%AD%E7%9A%84-std-ref-%E5%92%8C-cref-%E7%9A%84%E5%BC%95%E7%94%A8%E5%B0%81%E8%A3%85%E6%9C%BA%E5%88%B6/">
  <meta property="og:site_name" content="Luyangã®Blog">
  <meta property="og:title" content="ğŸ“Œæ·±å…¥ç†è§£ C&#43;&#43; ä¸­çš„ std ref å’Œ cref çš„å¼•ç”¨å°è£…æœºåˆ¶">
  <meta property="og:description" content="æ·±å…¥ç†è§£ C&#43;&#43; ä¸­çš„ std ref å’Œ cref çš„å¼•ç”¨å°è£…æœºåˆ¶ åœ¨ç°ä»£ C&#43;&#43; ç¼–ç¨‹ä¸­ï¼ŒæŒ‰å€¼ä¼ å‚æ˜¯å¸¸æ€ï¼Œä½†æœ‰æ—¶å€™æˆ‘ä»¬ç¡®å®éœ€è¦ä¼ å¼•ç”¨ã€‚å°¤å…¶æ˜¯åœ¨ä½¿ç”¨ std::bindã€std::threadã€æ ‡å‡†ç®—æ³•ç­‰åœºæ™¯ä¸‹ï¼Œå¦‚æœä¸åŠ æ³¨æ„ï¼ŒåŸæœ¬å¸Œæœ›ä¼ å¼•ç”¨çš„å˜é‡å´è¢«å¤åˆ¶ï¼Œå¯¼è‡´é€»è¾‘å¤±æ•ˆç”šè‡³ç¨‹åºå´©æºƒã€‚
æœ¬æ–‡å°†å¸¦ä½ æ·±å…¥ç†è§£ std::ref å’Œ std::cref çš„è®¾è®¡åŸç†ã€ä½¿ç”¨åœºæ™¯ä»¥åŠæ˜“è¸©çš„å‘ã€‚
ä¸ºä»€ä¹ˆéœ€è¦å¼•ç”¨å°è£…å™¨ å…ˆæ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼š
void increment(int&amp; x) { x&#43;&#43;; } int main() { int a = 5; std::thread t(increment, a); // âŒ ç¼–è¯‘å¤±è´¥ t.join(); } ä½ å¯èƒ½ä»¥ä¸ºæŠŠ a ä¼ è¿›å»å°±æ˜¯å¼•ç”¨äº†ï¼Œä½†äº‹å®å¹¶éå¦‚æ­¤ã€‚std::thread é»˜è®¤æŒ‰å€¼å¤åˆ¶å‚æ•°ã€‚å®ƒå°è¯•å°† a æ‹·è´ä¸€ä»½ä¼ é€’ç»™ incrementï¼Œè€Œ increment æœŸæœ›çš„æ˜¯ int&amp;ï¼Œäºæ˜¯ç¼–è¯‘å™¨æŠ¥é”™ã€‚
è¿™ä¸ªæ—¶å€™ï¼Œstd::ref(a) å°±æ´¾ä¸Šäº†ç”¨åœºï¼š
std::thread t(increment, std::ref(a)); // âœ… ä¼ å¼•ç”¨æˆåŠŸ std ref å’Œ cref æ˜¯ä»€ä¹ˆ std::ref(obj)ï¼šè¿”å›ä¸€ä¸ª å¯ä¿®æ”¹å¼•ç”¨ çš„åŒ…è£…å™¨ã€‚
std::cref(obj)ï¼šè¿”å›ä¸€ä¸ª const å¼•ç”¨ çš„åŒ…è£…å™¨ã€‚
è¿™ä¸¤ä¸ªå‡½æ•°æœ¬è´¨ä¸Šè¿”å›çš„æ˜¯ä¸€ä¸ª std::reference_wrapper&lt;T&gt; ç±»å‹ï¼Œå®ƒå¯ä»¥æ¨¡æ‹Ÿâ€œæŒ‰å¼•ç”¨ä¼ å‚â€çš„è¡Œä¸ºï¼Œä½†ä»ç„¶ä»¥â€œæŒ‰å€¼â€æ–¹å¼ä¼ é€’ç»™è°ƒç”¨è€…ã€‚">
  <meta property="og:locale" content="en_US">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-06-04T02:30:00+08:00">
    <meta property="article:modified_time" content="2025-06-04T02:30:00+08:00">
    <meta property="article:tag" content="Cpp">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="ğŸ“Œæ·±å…¥ç†è§£ C&#43;&#43; ä¸­çš„ std ref å’Œ cref çš„å¼•ç”¨å°è£…æœºåˆ¶">
  <meta name="twitter:description" content="æ·±å…¥ç†è§£ C&#43;&#43; ä¸­çš„ std ref å’Œ cref çš„å¼•ç”¨å°è£…æœºåˆ¶ åœ¨ç°ä»£ C&#43;&#43; ç¼–ç¨‹ä¸­ï¼ŒæŒ‰å€¼ä¼ å‚æ˜¯å¸¸æ€ï¼Œä½†æœ‰æ—¶å€™æˆ‘ä»¬ç¡®å®éœ€è¦ä¼ å¼•ç”¨ã€‚å°¤å…¶æ˜¯åœ¨ä½¿ç”¨ std::bindã€std::threadã€æ ‡å‡†ç®—æ³•ç­‰åœºæ™¯ä¸‹ï¼Œå¦‚æœä¸åŠ æ³¨æ„ï¼ŒåŸæœ¬å¸Œæœ›ä¼ å¼•ç”¨çš„å˜é‡å´è¢«å¤åˆ¶ï¼Œå¯¼è‡´é€»è¾‘å¤±æ•ˆç”šè‡³ç¨‹åºå´©æºƒã€‚
æœ¬æ–‡å°†å¸¦ä½ æ·±å…¥ç†è§£ std::ref å’Œ std::cref çš„è®¾è®¡åŸç†ã€ä½¿ç”¨åœºæ™¯ä»¥åŠæ˜“è¸©çš„å‘ã€‚
ä¸ºä»€ä¹ˆéœ€è¦å¼•ç”¨å°è£…å™¨ å…ˆæ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼š
void increment(int&amp; x) { x&#43;&#43;; } int main() { int a = 5; std::thread t(increment, a); // âŒ ç¼–è¯‘å¤±è´¥ t.join(); } ä½ å¯èƒ½ä»¥ä¸ºæŠŠ a ä¼ è¿›å»å°±æ˜¯å¼•ç”¨äº†ï¼Œä½†äº‹å®å¹¶éå¦‚æ­¤ã€‚std::thread é»˜è®¤æŒ‰å€¼å¤åˆ¶å‚æ•°ã€‚å®ƒå°è¯•å°† a æ‹·è´ä¸€ä»½ä¼ é€’ç»™ incrementï¼Œè€Œ increment æœŸæœ›çš„æ˜¯ int&amp;ï¼Œäºæ˜¯ç¼–è¯‘å™¨æŠ¥é”™ã€‚
è¿™ä¸ªæ—¶å€™ï¼Œstd::ref(a) å°±æ´¾ä¸Šäº†ç”¨åœºï¼š
std::thread t(increment, std::ref(a)); // âœ… ä¼ å¼•ç”¨æˆåŠŸ std ref å’Œ cref æ˜¯ä»€ä¹ˆ std::ref(obj)ï¼šè¿”å›ä¸€ä¸ª å¯ä¿®æ”¹å¼•ç”¨ çš„åŒ…è£…å™¨ã€‚
std::cref(obj)ï¼šè¿”å›ä¸€ä¸ª const å¼•ç”¨ çš„åŒ…è£…å™¨ã€‚
è¿™ä¸¤ä¸ªå‡½æ•°æœ¬è´¨ä¸Šè¿”å›çš„æ˜¯ä¸€ä¸ª std::reference_wrapper&lt;T&gt; ç±»å‹ï¼Œå®ƒå¯ä»¥æ¨¡æ‹Ÿâ€œæŒ‰å¼•ç”¨ä¼ å‚â€çš„è¡Œä¸ºï¼Œä½†ä»ç„¶ä»¥â€œæŒ‰å€¼â€æ–¹å¼ä¼ é€’ç»™è°ƒç”¨è€…ã€‚">

      <link rel="stylesheet" href="/css/root.min.0e732b812b9751962e01a7c4798a1211cd5f8ac8abec7f99793fe306989e459f.css" integrity="sha256-DnMrgSuXUZYuAafEeYoSEc1fisir7H&#43;ZeT/jBpieRZ8=" crossorigin="anonymous">
      <link rel="stylesheet" href="/css/bundle.min.d95a325399a05b50fe47dcf35b8229b8a2a014fcee5435cfb28204c6ac335fc5.css" integrity="sha256-2VoyU5mgW1D&#43;R9zzW4IpuKKgFPzuVDXPsoIExqwzX8U=" crossorigin="anonymous">

      <script src="/js/bundle.cc8ae9952dbfb731affafabdf26e5c60a6910047ff59ccdeaf1daebaa26c8830.js" integrity="sha256-zIrplS2/tzGv&#43;vq98m5cYKaRAEf/Wczerx2uuqJsiDA=" crossorigin="anonymous"></script><script defer src="/js/search/flexsearch.compact.64594b125f7b78bdf4fa8316955922bbebb1cd6baef3f16654bfca20309f18f8.js" integrity="sha256-ZFlLEl97eL30&#43;oMWlVkiu&#43;uxzWuu8/FmVL/KIDCfGPg="></script>
<script defer src="/js/search/search.1d980f84df11f3eb7c8c5f17f541d49a0611608df179dd74fa7f06225eb56ace.js" integrity="sha256-HZgPhN8R8&#43;t8jF8X9UHUmgYRYI3xed10&#43;n8GIl61as4="></script>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Spectral:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,200;1,300;1,400;1,500;1,600;1,700;1,800&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:opsz,wght@12..96,200..800&family=Spectral:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,200;1,300;1,400;1,500;1,600;1,700;1,800&display=swap" rel="stylesheet">

</head>
<body class="notransition">
  <div id="container">
    <header id="main-header"><div role="navigation" aria-label="Main">
  <div class="nav-left">
    <a href="/" style="color: inherit;">Luyangã®Blog</a>
  </div>
  <div class="nav-right">
    <div style="position:absolute;width:0px;height:0px;">
      <div id="nav-dropdown-menu" class="hidden" href="#">
    <div class="nav-item">
      <a aria-current="true" class="ancestor" href="/posts/"
      >Posts</a>
    </div>
    <div class="nav-item">
      <a href="/features/"
      >Features</a>
    </div>
    <div class="nav-item">
      <a href="/about/"
      >About</a>
    </div>
</div>
    </div>
    <a id="nav-dropdown-button" href="#"><svg width="20px" height="20px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M4 6H20M4 12H20M4 18H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
</a>
    <div id="nav-menu">
    <div class="nav-item">
      <a aria-current="true" class="ancestor" href="/posts/"
      >Posts</a>
    </div>
    <div class="nav-item">
      <a href="/features/"
      >Features</a>
    </div>
    <div class="nav-item">
      <a href="/about/"
      >About</a>
    </div>
</div>
    <a id="theme-switcher" href="#">
<svg class="light-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M12 3V4M12 20V21M4 12H3M6.31412 6.31412L5.5 5.5M17.6859 6.31412L18.5 5.5M6.31412 17.69L5.5 18.5001M17.6859 17.69L18.5 18.5001M21 12H20M16 12C16 14.2091 14.2091 16 12 16C9.79086 16 8 14.2091 8 12C8 9.79086 9.79086 8 12 8C14.2091 8 16 9.79086 16 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>

<svg class="dark-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M3.32031 11.6835C3.32031 16.6541 7.34975 20.6835 12.3203 20.6835C16.1075 20.6835 19.3483 18.3443 20.6768 15.032C19.6402 15.4486 18.5059 15.6834 17.3203 15.6834C12.3497 15.6834 8.32031 11.654 8.32031 6.68342C8.32031 5.50338 8.55165 4.36259 8.96453 3.32996C5.65605 4.66028 3.32031 7.89912 3.32031 11.6835Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
</a>
  </div>
</div>
</header>
    <div class="flex grow">
      <div id="main-pane">
        <main id="main-content"><div class="single-header">
<ol class="breadcrumbs" itemscope itemtype="https://schema.org/BreadcrumbList">
    <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
      <a itemprop="item" href="/">
        <span itemprop="name">Home</span>
      </a>
      <meta itemprop="position" content='1' />
    </li>
    <span>&nbspÂ»&nbsp</span>
    <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
      <a itemprop="item" href="/posts/">
        <span itemprop="name">Posts</span>
      </a>
      <meta itemprop="position" content='2' />
    </li>
    <span>&nbspÂ»&nbsp</span>
</ol>
<h1>ğŸ“Œæ·±å…¥ç†è§£ C&#43;&#43; ä¸­çš„ std ref å’Œ cref çš„å¼•ç”¨å°è£…æœºåˆ¶</h1><time class="dim" datetime="2025-06-04T02:30:00&#43;08:00">June 4, 2025</time><div class="term-container"><div class="tag">
        <a href="/tags/cpp/">#cpp</a>
      </div></ol></div>
  <section class="page-section"><h1 id="æ·±å…¥ç†è§£-c-ä¸­çš„-std-ref-å’Œ-cref-çš„å¼•ç”¨å°è£…æœºåˆ¶">æ·±å…¥ç†è§£ C++ ä¸­çš„ std ref å’Œ cref çš„å¼•ç”¨å°è£…æœºåˆ¶</h1>
<blockquote>
<p>åœ¨ç°ä»£ C++ ç¼–ç¨‹ä¸­ï¼Œ<strong>æŒ‰å€¼ä¼ å‚æ˜¯å¸¸æ€ï¼Œä½†æœ‰æ—¶å€™æˆ‘ä»¬ç¡®å®éœ€è¦ä¼ å¼•ç”¨</strong>ã€‚å°¤å…¶æ˜¯åœ¨ä½¿ç”¨ <code>std::bind</code>ã€<code>std::thread</code>ã€æ ‡å‡†ç®—æ³•ç­‰åœºæ™¯ä¸‹ï¼Œå¦‚æœä¸åŠ æ³¨æ„ï¼ŒåŸæœ¬å¸Œæœ›ä¼ å¼•ç”¨çš„å˜é‡å´è¢«å¤åˆ¶ï¼Œå¯¼è‡´é€»è¾‘å¤±æ•ˆç”šè‡³ç¨‹åºå´©æºƒã€‚<br>
æœ¬æ–‡å°†å¸¦ä½ æ·±å…¥ç†è§£ <code>std::ref</code> å’Œ <code>std::cref</code> çš„è®¾è®¡åŸç†ã€ä½¿ç”¨åœºæ™¯ä»¥åŠæ˜“è¸©çš„å‘ã€‚</p>
</blockquote>
<hr>
<h2 id="ä¸ºä»€ä¹ˆéœ€è¦å¼•ç”¨å°è£…å™¨">ä¸ºä»€ä¹ˆéœ€è¦å¼•ç”¨å°è£…å™¨</h2>
<p>å…ˆæ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">increment</span>(<span style="color:#66d9ef">int</span><span style="color:#f92672">&amp;</span> x) {
</span></span><span style="display:flex;"><span>    x<span style="color:#f92672">++</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> a <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>;
</span></span><span style="display:flex;"><span>    std<span style="color:#f92672">::</span><span style="color:#66d9ef">thread</span> t(increment, a);  <span style="color:#75715e">// âŒ ç¼–è¯‘å¤±è´¥
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    t.join();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>ä½ å¯èƒ½ä»¥ä¸ºæŠŠ <code>a</code> ä¼ è¿›å»å°±æ˜¯å¼•ç”¨äº†ï¼Œä½†äº‹å®å¹¶éå¦‚æ­¤ã€‚<code>std::thread</code> é»˜è®¤æŒ‰å€¼å¤åˆ¶å‚æ•°ã€‚å®ƒå°è¯•å°† <code>a</code> æ‹·è´ä¸€ä»½ä¼ é€’ç»™ <code>increment</code>ï¼Œè€Œ <code>increment</code> æœŸæœ›çš„æ˜¯ <code>int&amp;</code>ï¼Œäºæ˜¯ç¼–è¯‘å™¨æŠ¥é”™ã€‚</p>
<p>è¿™ä¸ªæ—¶å€™ï¼Œ<code>std::ref(a)</code> å°±æ´¾ä¸Šäº†ç”¨åœºï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>std<span style="color:#f92672">::</span><span style="color:#66d9ef">thread</span> t(increment, std<span style="color:#f92672">::</span>ref(a));  <span style="color:#75715e">// âœ… ä¼ å¼•ç”¨æˆåŠŸ
</span></span></span></code></pre></div><hr>
<h2 id="std-ref-å’Œ-cref-æ˜¯ä»€ä¹ˆ">std ref å’Œ cref æ˜¯ä»€ä¹ˆ</h2>
<ul>
<li>
<p><code>std::ref(obj)</code>ï¼šè¿”å›ä¸€ä¸ª <strong>å¯ä¿®æ”¹å¼•ç”¨</strong> çš„åŒ…è£…å™¨ã€‚</p>
</li>
<li>
<p><code>std::cref(obj)</code>ï¼šè¿”å›ä¸€ä¸ª <strong>const å¼•ç”¨</strong> çš„åŒ…è£…å™¨ã€‚</p>
</li>
</ul>
<p>è¿™ä¸¤ä¸ªå‡½æ•°æœ¬è´¨ä¸Šè¿”å›çš„æ˜¯ä¸€ä¸ª <code>std::reference_wrapper&lt;T&gt;</code> ç±»å‹ï¼Œå®ƒå¯ä»¥æ¨¡æ‹Ÿâ€œæŒ‰å¼•ç”¨ä¼ å‚â€çš„è¡Œä¸ºï¼Œä½†ä»ç„¶ä»¥â€œæŒ‰å€¼â€æ–¹å¼ä¼ é€’ç»™è°ƒç”¨è€…ã€‚</p>
<hr>
<h2 id="å…¸å‹ä½¿ç”¨åœºæ™¯">å…¸å‹ä½¿ç”¨åœºæ™¯</h2>
<h3 id="1-stdthread">1. std::thread</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">print</span>(<span style="color:#66d9ef">int</span><span style="color:#f92672">&amp;</span> x) {
</span></span><span style="display:flex;"><span>    std<span style="color:#f92672">::</span>cout <span style="color:#f92672">&lt;&lt;</span> x <span style="color:#f92672">&lt;&lt;</span> std<span style="color:#f92672">::</span>endl;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> a <span style="color:#f92672">=</span> <span style="color:#ae81ff">42</span>;
</span></span><span style="display:flex;"><span>    std<span style="color:#f92672">::</span><span style="color:#66d9ef">thread</span> t(print, std<span style="color:#f92672">::</span>ref(a));  <span style="color:#75715e">// âœ… æŒ‰å¼•ç”¨ä¼ å…¥
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    t.join();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>å¦‚æœä¸ä½¿ç”¨ <code>std::ref</code>ï¼Œä»£ç ä¼šå› ä¸ºå¼•ç”¨ç»‘å®šå¤±è´¥è€Œæ— æ³•é€šè¿‡ç¼–è¯‘ã€‚</p>
<hr>
<h3 id="2-stdbind">2. std::bind</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;functional&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">set_to_100</span>(<span style="color:#66d9ef">int</span><span style="color:#f92672">&amp;</span> x) {
</span></span><span style="display:flex;"><span>    x <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> a <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">auto</span> f <span style="color:#f92672">=</span> std<span style="color:#f92672">::</span>bind(set_to_100, std<span style="color:#f92672">::</span>ref(a));
</span></span><span style="display:flex;"><span>    f();  <span style="color:#75715e">// âœ… æˆåŠŸä¿®æ”¹ a
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><p>è‹¥ä¸ä½¿ç”¨ <code>std::ref</code>ï¼Œ<code>a</code> ä¼šè¢«æ‹·è´ï¼Œ<code>set_to_100</code> å†…éƒ¨ä¿®æ”¹çš„æ˜¯æ‹·è´ï¼Œè€Œä¸æ˜¯åŸå˜é‡ã€‚</p>
<hr>
<h3 id="3-æ ‡å‡†ç®—æ³•">3. æ ‡å‡†ç®—æ³•</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;algorithm&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;iostream&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;vector&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;functional&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">print</span>(<span style="color:#66d9ef">int</span> x) { std<span style="color:#f92672">::</span>cout <span style="color:#f92672">&lt;&lt;</span> x <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34; &#34;</span>; }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    std<span style="color:#f92672">::</span>vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> data{<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>};
</span></span><span style="display:flex;"><span>    std<span style="color:#f92672">::</span>for_each(data.begin(), data.end(), std<span style="color:#f92672">::</span>ref(print));  <span style="color:#75715e">// âœ… å¼•ç”¨å‡½æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><hr>
<h2 id="cref-çš„ä½¿ç”¨åœºæ™¯">cref çš„ä½¿ç”¨åœºæ™¯</h2>
<p>å½“ä½ å¸Œæœ›ä»¥åªè¯»å¼•ç”¨æ–¹å¼ä¼ å‚æ—¶ï¼Œä½¿ç”¨ <code>std::cref</code>ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">show</span>(<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">&amp;</span> x) {
</span></span><span style="display:flex;"><span>    std<span style="color:#f92672">::</span>cout <span style="color:#f92672">&lt;&lt;</span> x <span style="color:#f92672">&lt;&lt;</span> std<span style="color:#f92672">::</span>endl;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> val <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">auto</span> f <span style="color:#f92672">=</span> std<span style="color:#f92672">::</span>bind(show, std<span style="color:#f92672">::</span>cref(val));
</span></span><span style="display:flex;"><span>    f();  <span style="color:#75715e">// è¾“å‡º 10
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><hr>
<h2 id="å®ç°åŸç†ç®€æ">å®ç°åŸç†ç®€æ</h2>
<p>æ ‡å‡†åº“ä¸­çš„ <code>reference_wrapper</code> æœ¬è´¨ä¸Šå°±æ˜¯ç”¨ä¸€ä¸ªæŒ‡é’ˆæ¨¡æ‹Ÿå¼•ç”¨ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#66d9ef">template</span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">typename</span> T<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">reference_wrapper</span> {
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">explicit</span> reference_wrapper(T<span style="color:#f92672">&amp;</span> ref) <span style="color:#66d9ef">noexcept</span> <span style="color:#f92672">:</span> ptr(std<span style="color:#f92672">::</span>addressof(ref)) {}
</span></span><span style="display:flex;"><span>    T<span style="color:#f92672">&amp;</span> get() <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">noexcept</span> { <span style="color:#66d9ef">return</span> <span style="color:#f92672">*</span>ptr; }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">operator</span> T<span style="color:#f92672">&amp;</span>() <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">noexcept</span> { <span style="color:#66d9ef">return</span> <span style="color:#f92672">*</span>ptr; }
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>    T<span style="color:#f92672">*</span> ptr;
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><p>è¿™ä¹Ÿæ„å‘³ç€ï¼š</p>
<ul>
<li>
<p><code>reference_wrapper</code> <strong>ä¸ä¼šå»¶é•¿åŸå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸ</strong></p>
</li>
<li>
<p><code>ref</code> å’Œ <code>cref</code> éƒ½<strong>åªèƒ½ç»‘å®šå·¦å€¼</strong></p>
</li>
</ul>
<hr>
<h2 id="ä½¿ç”¨æ³¨æ„äº‹é¡¹">ä½¿ç”¨æ³¨æ„äº‹é¡¹</h2>
<h3 id="1-ä¸å¯ç»‘å®šå³å€¼">1. ä¸å¯ç»‘å®šå³å€¼</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>std<span style="color:#f92672">::</span>ref(<span style="color:#ae81ff">42</span>);     <span style="color:#75715e">// âŒ é”™è¯¯ï¼šä¸èƒ½å¯¹ä¸´æ—¶å¯¹è±¡åˆ›å»ºå¯ä¿®æ”¹å¼•ç”¨
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>std<span style="color:#f92672">::</span>cref(<span style="color:#ae81ff">42</span>);    <span style="color:#75715e">// âœ… æ­£ç¡®ï¼šconst å¼•ç”¨å¯ä»¥ç»‘å®šå³å€¼
</span></span></span></code></pre></div><h3 id="2-ç”Ÿå‘½å‘¨æœŸé—®é¢˜">2. ç”Ÿå‘½å‘¨æœŸé—®é¢˜</h3>
<p>ä¸è¦å¯¹ä¸´æ—¶å˜é‡ä½¿ç”¨ <code>std::ref</code>ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#66d9ef">auto</span> f <span style="color:#f92672">=</span> std<span style="color:#f92672">::</span>bind(print, std<span style="color:#f92672">::</span>ref(temp()));  <span style="color:#75715e">// âŒ æ‚¬å‚å¼•ç”¨
</span></span></span></code></pre></div><hr>
<h2 id="åº”ç”¨æ€»ç»“">åº”ç”¨æ€»ç»“</h2>
<table>
  <thead>
      <tr>
          <th>åœºæ™¯</th>
          <th>é»˜è®¤ä¼ å€¼ï¼Ÿ</th>
          <th>æ˜¯å¦æ¨èä½¿ç”¨ ref/cref</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>std::thread</code></td>
          <td>âœ…</td>
          <td>âœ…</td>
      </tr>
      <tr>
          <td><code>std::bind</code></td>
          <td>âœ…</td>
          <td>âœ…</td>
      </tr>
      <tr>
          <td><code>std::function</code></td>
          <td>âœ…ï¼ˆæ•è·æ‹·è´ï¼‰</td>
          <td>âœ…</td>
      </tr>
      <tr>
          <td><code>for_each</code> / ç®—æ³•</td>
          <td>âœ…</td>
          <td>âœ…</td>
      </tr>
      <tr>
          <td>Lambda æ•è·</td>
          <td>å¯é€‰ï¼ˆå€¼/å¼•ç”¨ï¼‰</td>
          <td>âŒ æ¨è <code>[&amp;]</code> æ•è·</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="ç»“è¯­">ç»“è¯­</h2>
<p><code>std::ref</code> å’Œ <code>std::cref</code> æ˜¯ç°ä»£ C++ ä¸­éå¸¸å®ç”¨çš„å°å·¥å…·ï¼Œå®ƒä»¬è®©ä½ èƒ½å¤Ÿå®‰å…¨ã€æ˜¾å¼åœ°åœ¨å€¼è¯­ä¹‰ä¸Šä¸‹æ–‡ä¸­ä¼ é€’å¼•ç”¨ï¼Œé¿å…æ‹·è´ã€ä¿æŒè¯­ä¹‰æ¸…æ™°ã€‚<br>
åœ¨å¤šçº¿ç¨‹ã€å‡½æ•°ç»‘å®šã€ç®—æ³•è°ƒç”¨ç­‰åœºæ™¯ä¸‹ï¼Œå®ƒä»¬èƒ½å¤Ÿæ˜¾è‘—æé«˜ä»£ç çš„æ­£ç¡®æ€§ä¸è¡¨è¾¾åŠ›ã€‚</p>
<p>ä¸‹æ¬¡é‡åˆ°æŒ‰å€¼è°ƒç”¨çš„é—®é¢˜ï¼Œä¸å¦¨è¯•ç€æƒ³ä¸€æƒ³ï¼š<strong>è¿™é‡Œæ˜¯ä¸æ˜¯è¯¥ç”¨ <code>std::ref</code> æˆ– <code>std::cref</code>ï¼Ÿ</strong></p>
<hr>
<p>ğŸ“š æ¨èé˜…è¯»ï¼š</p>
<ul>
<li><a href="https://en.cppreference.com/w/cpp/utility/functional/ref">cppreferenceï¼šstd::ref</a></li>
<li>ã€ŠEffective Modern C++ã€‹ç¬¬ 22 æ¡ï¼šé¿å…æ„å¤–æŒ‰å€¼ä¼ å‚</li>
</ul>
</section></main>
        <footer id="main-footer"><div class="footer">
  <a href="#">Scroll to Top</a>
  <div class="footer-copyright">
    <div class="dim">Â© 2026 Lu Yang</div>
    <div>Made with â¤ï¸ and powered by <a href="https://github.com/math-queiroz/rusty-typewriter" target="_blank">Rusty Typewriter</a> theme for <a href="https://gohugo.io/" target="_blank">Hugo</a></div>
  </div>
</div>
</footer>
      </div><aside id="side-pane" class="side-sticky"><div class="side-details">
    <span>318 words</span>
    <span>3 - 5 minutes read</span></div><h3>Table Of Contents</h3><nav id="TableOfContents">
  <ul>
    <li><a href="#ä¸ºä»€ä¹ˆéœ€è¦å¼•ç”¨å°è£…å™¨">ä¸ºä»€ä¹ˆéœ€è¦å¼•ç”¨å°è£…å™¨</a></li>
    <li><a href="#std-ref-å’Œ-cref-æ˜¯ä»€ä¹ˆ">std ref å’Œ cref æ˜¯ä»€ä¹ˆ</a></li>
    <li><a href="#å…¸å‹ä½¿ç”¨åœºæ™¯">å…¸å‹ä½¿ç”¨åœºæ™¯</a>
      <ul>
        <li><a href="#1-stdthread">1. std::thread</a></li>
        <li><a href="#2-stdbind">2. std::bind</a></li>
        <li><a href="#3-æ ‡å‡†ç®—æ³•">3. æ ‡å‡†ç®—æ³•</a></li>
      </ul>
    </li>
    <li><a href="#cref-çš„ä½¿ç”¨åœºæ™¯">cref çš„ä½¿ç”¨åœºæ™¯</a></li>
    <li><a href="#å®ç°åŸç†ç®€æ">å®ç°åŸç†ç®€æ</a></li>
    <li><a href="#ä½¿ç”¨æ³¨æ„äº‹é¡¹">ä½¿ç”¨æ³¨æ„äº‹é¡¹</a>
      <ul>
        <li><a href="#1-ä¸å¯ç»‘å®šå³å€¼">1. ä¸å¯ç»‘å®šå³å€¼</a></li>
        <li><a href="#2-ç”Ÿå‘½å‘¨æœŸé—®é¢˜">2. ç”Ÿå‘½å‘¨æœŸé—®é¢˜</a></li>
      </ul>
    </li>
    <li><a href="#åº”ç”¨æ€»ç»“">åº”ç”¨æ€»ç»“</a></li>
    <li><a href="#ç»“è¯­">ç»“è¯­</a></li>
  </ul>
</nav><h3>Related</h3>
    <ul><li><a href="/posts/-c&#43;&#43;-%E7%B1%BB%E6%88%90%E5%91%98%E5%87%BD%E6%95%B0-static-%E4%B8%8E-const-%E7%9A%84%E5%A3%B0%E6%98%8E%E4%B8%8E%E5%AE%9A%E4%B9%89%E8%A7%84%E5%88%99%E8%A7%A3%E6%9E%90/">ğŸ“Œ C&#43;&#43;ç±»æˆå‘˜å‡½æ•° static ä¸ const çš„å£°æ˜ä¸å®šä¹‰è§„åˆ™è§£æ</a></li><li><a href="/posts/%E5%B0%8F%E5%AF%B9%E8%B1%A1%E4%BC%98%E5%8C%96small-object-optimization%E6%B7%B1%E5%BA%A6%E8%A7%A3%E6%9E%90c&#43;&#43;%E5%AE%B9%E5%99%A8%E7%9A%84%E6%80%A7%E8%83%BD%E5%88%A9%E5%99%A8/">ğŸ“Œå°å¯¹è±¡ä¼˜åŒ–ï¼ˆSmall Object Optimizationï¼‰æ·±åº¦è§£æï¼šC&#43;&#43;å®¹å™¨çš„æ€§èƒ½åˆ©å™¨</a></li><li><a href="/posts/%E6%B7%B1%E5%85%A5%E5%88%86%E6%9E%90-delete-%E4%B8%8E%E7%A7%81%E6%9C%89%E5%8C%96%E6%9E%84%E9%80%A0%E5%92%8C%E6%9E%90%E6%9E%84%E5%87%BD%E6%95%B0%E7%9A%84%E6%9C%AC%E8%B4%A8%E5%8C%BA%E5%88%AB/">ğŸ“Œæ·±å…¥åˆ†æ =delete ä¸ç§æœ‰åŒ–æ„é€ å’Œææ„å‡½æ•°çš„æœ¬è´¨åŒºåˆ«</a></li><li><a href="/posts/-c&#43;&#43;%E9%9D%9E%E4%BE%B5%E5%85%A5%E6%80%A7%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8F/">ğŸ“˜ C&#43;&#43;éä¾µå…¥æ€§ç¼–ç¨‹èŒƒå¼</a></li><li><a href="/posts/-pingpong-buffer-%E8%AE%BE%E8%AE%A1%E6%96%87%E6%A1%A3/">ğŸ“˜ PingPong Buffer è®¾è®¡æ–‡æ¡£</a></li></ul></aside></div>
  </div>
</body>
</html>
