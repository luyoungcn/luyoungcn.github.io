<!DOCTYPE html>
<html lang="en-US" dir="ltr">
<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>🎯 YOLO 实时目标检测笔记：Windows 摄像头推流 &#43; WSL YOLO 识别 | LuyangのBlog</title>
<link rel="icon" href="favicon.svg" sizes="any" type="image/svg+xml" /><meta property="og:url" content="/posts/-yolo-%E5%AE%9E%E6%97%B6%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B%E7%AC%94%E8%AE%B0windows-%E6%91%84%E5%83%8F%E5%A4%B4%E6%8E%A8%E6%B5%81-&#43;-wsl-yolo-%E8%AF%86%E5%88%AB/">
  <meta property="og:site_name" content="LuyangのBlog">
  <meta property="og:title" content="🎯 YOLO 实时目标检测笔记：Windows 摄像头推流 &#43; WSL YOLO 识别">
  <meta property="og:description" content="环境声明 $ lsb_release -a No LSB modules are available. Distributor ID: Ubuntu Description: Ubuntu 20.04.6 LTS Release: 20.04 Codename: focal 🎯 YOLO 实时目标检测笔记：Windows 摄像头推流 &#43; WSL YOLO 识别 🧩 场景说明 Windows 端摄像头（如 HP 5MP Camera） 使用 ffmpeg 推流至本地 RTSP 服务器 WSL 中运行 Ultralytics YOLO，读取 RTSP 流进行目标检测 ⚙️ 环境配置（WSL 中） ✅ 安装依赖 pip install -U pip pip install opencv-python pip install torch torchvision torchaudio ✅ 安装 Ultralytics（源码模式） # 克隆仓库 git clone https://github.com/ultralytics/ultralytics # 进入目录 cd ultralytics # 以开发模式安装（editable） # pip install -e . python3 -m pip install -e . ✅ 优势：你可以随时修改 YOLO 源码，调试/开发更灵活。">
  <meta property="og:locale" content="en_US">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-06-27T02:30:00+08:00">
    <meta property="article:modified_time" content="2025-06-27T02:30:00+08:00">
    <meta property="article:tag" content="Python">
    <meta property="article:tag" content="YOLO">
    <meta property="article:tag" content="OpenCV">
    <meta property="article:tag" content="Wsl">
    <meta property="article:tag" content="Windows">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="🎯 YOLO 实时目标检测笔记：Windows 摄像头推流 &#43; WSL YOLO 识别">
  <meta name="twitter:description" content="环境声明 $ lsb_release -a No LSB modules are available. Distributor ID: Ubuntu Description: Ubuntu 20.04.6 LTS Release: 20.04 Codename: focal 🎯 YOLO 实时目标检测笔记：Windows 摄像头推流 &#43; WSL YOLO 识别 🧩 场景说明 Windows 端摄像头（如 HP 5MP Camera） 使用 ffmpeg 推流至本地 RTSP 服务器 WSL 中运行 Ultralytics YOLO，读取 RTSP 流进行目标检测 ⚙️ 环境配置（WSL 中） ✅ 安装依赖 pip install -U pip pip install opencv-python pip install torch torchvision torchaudio ✅ 安装 Ultralytics（源码模式） # 克隆仓库 git clone https://github.com/ultralytics/ultralytics # 进入目录 cd ultralytics # 以开发模式安装（editable） # pip install -e . python3 -m pip install -e . ✅ 优势：你可以随时修改 YOLO 源码，调试/开发更灵活。">

      <link rel="stylesheet" href="/css/root.min.0e732b812b9751962e01a7c4798a1211cd5f8ac8abec7f99793fe306989e459f.css" integrity="sha256-DnMrgSuXUZYuAafEeYoSEc1fisir7H&#43;ZeT/jBpieRZ8=" crossorigin="anonymous">
      <link rel="stylesheet" href="/css/bundle.min.ffb26980ae2df7bdfe47815d8a3f0130f36070ee4a3320a5f22d16842be2537f.css" integrity="sha256-/7JpgK4t973&#43;R4Fdij8BMPNgcO5KMyCl8i0WhCviU38=" crossorigin="anonymous">

      <script src="/js/bundle.995e4ec99401021e081ec256bee66154ef7f4e5136809432513b2e6d014b4b1d.js" integrity="sha256-mV5OyZQBAh4IHsJWvuZhVO9/TlE2gJQyUTsubQFLSx0=" crossorigin="anonymous"></script><script defer src="/js/search/flexsearch.compact.64594b125f7b78bdf4fa8316955922bbebb1cd6baef3f16654bfca20309f18f8.js" integrity="sha256-ZFlLEl97eL30&#43;oMWlVkiu&#43;uxzWuu8/FmVL/KIDCfGPg="></script>
<script defer src="/js/search/search.1d980f84df11f3eb7c8c5f17f541d49a0611608df179dd74fa7f06225eb56ace.js" integrity="sha256-HZgPhN8R8&#43;t8jF8X9UHUmgYRYI3xed10&#43;n8GIl61as4="></script>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Spectral:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,200;1,300;1,400;1,500;1,600;1,700;1,800&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:opsz,wght@12..96,200..800&family=Spectral:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,200;1,300;1,400;1,500;1,600;1,700;1,800&display=swap" rel="stylesheet">

</head>
<body class="notransition">
  <div id="container">
    <header id="main-header"><div role="navigation" aria-label="Main">
  <div class="nav-left">
    <a href="/" style="color: inherit;">LuyangのBlog</a>
  </div>
  <div class="nav-right">
    <div style="position:absolute;width:0px;height:0px;">
      <div id="nav-dropdown-menu" class="hidden" href="#">
    <div class="nav-item">
      <a aria-current="true" class="ancestor" href="/posts/"
      >Posts</a>
    </div>
    <div class="nav-item">
      <a href="/features/"
      >Features</a>
    </div>
    <div class="nav-item">
      <a href="/about/"
      >About</a>
    </div>
</div>
    </div>
    <a id="nav-dropdown-button" href="#"><svg width="20px" height="20px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M4 6H20M4 12H20M4 18H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
</a>
    <div id="nav-menu">
    <div class="nav-item">
      <a aria-current="true" class="ancestor" href="/posts/"
      >Posts</a>
    </div>
    <div class="nav-item">
      <a href="/features/"
      >Features</a>
    </div>
    <div class="nav-item">
      <a href="/about/"
      >About</a>
    </div>
</div>
    <a id="theme-switcher" href="#">
<svg class="light-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M12 3V4M12 20V21M4 12H3M6.31412 6.31412L5.5 5.5M17.6859 6.31412L18.5 5.5M6.31412 17.69L5.5 18.5001M17.6859 17.69L18.5 18.5001M21 12H20M16 12C16 14.2091 14.2091 16 12 16C9.79086 16 8 14.2091 8 12C8 9.79086 9.79086 8 12 8C14.2091 8 16 9.79086 16 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>

<svg class="dark-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M3.32031 11.6835C3.32031 16.6541 7.34975 20.6835 12.3203 20.6835C16.1075 20.6835 19.3483 18.3443 20.6768 15.032C19.6402 15.4486 18.5059 15.6834 17.3203 15.6834C12.3497 15.6834 8.32031 11.654 8.32031 6.68342C8.32031 5.50338 8.55165 4.36259 8.96453 3.32996C5.65605 4.66028 3.32031 7.89912 3.32031 11.6835Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
</a>
  </div>
</div>
</header>
    <div class="flex grow">
      <div id="main-pane">
        <main id="main-content"><div class="single-header">
<ol class="breadcrumbs" itemscope itemtype="https://schema.org/BreadcrumbList">
    <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
      <a itemprop="item" href="/">
        <span itemprop="name">Home</span>
      </a>
      <meta itemprop="position" content='1' />
    </li>
    <span>&nbsp»&nbsp</span>
    <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
      <a itemprop="item" href="/posts/">
        <span itemprop="name">Posts</span>
      </a>
      <meta itemprop="position" content='2' />
    </li>
    <span>&nbsp»&nbsp</span>
</ol>
<h1>🎯 YOLO 实时目标检测笔记：Windows 摄像头推流 &#43; WSL YOLO 识别</h1><time class="dim" datetime="2025-06-27T02:30:00&#43;08:00">June 27, 2025</time><div class="term-container"><div class="tag">
        <a href="/tags/python/">#Python</a>
      </div><div class="tag">
        <a href="/tags/yolo/">#YOLO</a>
      </div><div class="tag">
        <a href="/tags/opencv/">#OpenCV</a>
      </div><div class="tag">
        <a href="/tags/wsl/">#wsl</a>
      </div><div class="tag">
        <a href="/tags/windows/">#windows</a>
      </div></ol></div>
  <section class="page-section"><h2 id="环境声明">环境声明</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ lsb_release -a
</span></span><span style="display:flex;"><span>No LSB modules are available.
</span></span><span style="display:flex;"><span>Distributor ID: Ubuntu
</span></span><span style="display:flex;"><span>Description:    Ubuntu 20.04.6 LTS
</span></span><span style="display:flex;"><span>Release:        20.04
</span></span><span style="display:flex;"><span>Codename:       focal
</span></span></code></pre></div><h1 id="-yolo-实时目标检测笔记windows-摄像头推流--wsl-yolo-识别">🎯 YOLO 实时目标检测笔记：Windows 摄像头推流 + WSL YOLO 识别</h1>
<h2 id="-场景说明">🧩 场景说明</h2>
<ul>
<li>Windows 端摄像头（如 HP 5MP Camera）</li>
<li>使用 <code>ffmpeg</code> 推流至本地 RTSP 服务器</li>
<li>WSL 中运行 Ultralytics YOLO，读取 RTSP 流进行目标检测</li>
</ul>
<hr>
<h2 id="-环境配置wsl-中">⚙️ 环境配置（WSL 中）</h2>
<h3 id="-安装依赖">✅ 安装依赖</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>pip install -U pip
</span></span><span style="display:flex;"><span>pip install opencv-python
</span></span><span style="display:flex;"><span>pip install torch torchvision torchaudio
</span></span></code></pre></div><h3 id="-安装-ultralytics源码模式">✅ 安装 Ultralytics（源码模式）</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 克隆仓库</span>
</span></span><span style="display:flex;"><span>git clone https://github.com/ultralytics/ultralytics
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 进入目录</span>
</span></span><span style="display:flex;"><span>cd ultralytics
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 以开发模式安装（editable）</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># pip install -e .</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>python3 -m pip install -e .
</span></span></code></pre></div><blockquote>
<p>✅ 优势：你可以随时修改 YOLO 源码，调试/开发更灵活。</p></blockquote>
<hr>
<h2 id="-步骤一安装并运行-rtsp-服务器mediamtx">✅ 步骤一：安装并运行 RTSP 服务器（mediamtx）</h2>
<p>推荐使用轻量开源 RTSP 服务器 <a href="https://github.com/bluenviron/mediamtx"><strong>mediamtx</strong>（原 rtsp-simple-server）</a></p>
<h3 id="安装wsl-中">安装（WSL 中）：</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>wget https://github.com/bluenviron/mediamtx/releases/download/v1.12.3/mediamtx_v1.12.3_linux_amd64.tar.gz
</span></span><span style="display:flex;"><span>tar -xvzf mediamtx_linux_amd64.tar.gz
</span></span><span style="display:flex;"><span>cd mediamtx
</span></span><span style="display:flex;"><span>./mediamtx
</span></span></code></pre></div><hr>
<h2 id="-步骤二windows-端摄像头推流ffmpeg">✅ 步骤二：Windows 端摄像头推流（FFmpeg）</h2>
<p>推荐推流命令如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ffmpeg -f dshow -i video<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;HP 5MP Camera&#34;</span> -vf <span style="color:#e6db74">&#34;yadif,format=yuv420p&#34;</span> -vcodec libx264 -preset ultrafast -tune zerolatency -color_primaries bt709 -colorspace bt709 -color_trc bt709 -r <span style="color:#ae81ff">30</span> -g <span style="color:#ae81ff">30</span> -threads <span style="color:#ae81ff">2</span> -pix_fmt yuv420p -f rtsp rtsp://172.20.24.196:8554/live.sdp
</span></span></code></pre></div><hr>
<h2 id="-步骤三wsl-中运行-yolo-目标检测">✅ 步骤三：WSL 中运行 YOLO 目标检测</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>yolo detect predict <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    model<span style="color:#f92672">=</span>yolov8n.pt <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    source<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;rtsp://127.0.0.1:8554/live.sdp&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    show<span style="color:#f92672">=</span>True <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    device<span style="color:#f92672">=</span>cpu
</span></span></code></pre></div><hr>
<h2 id="-可选调试-rtsp-流">✅ 可选：调试 RTSP 流</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ffplay rtsp://127.0.0.1:8554/live.sdp
</span></span></code></pre></div><hr>
<h2 id="-常见问题排查">💡 常见问题排查</h2>
<table>
  <thead>
      <tr>
          <th>问题</th>
          <th>原因或解决方案</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>udp://</code> 无法打开</td>
          <td>YOLO 不完全支持，推荐使用 <code>rtsp://</code> 转发</td>
      </tr>
      <tr>
          <td>YOLO 无法连接 RTSP</td>
          <td>确保 RTSP 服务在运行，FFmpeg 正常推送</td>
      </tr>
      <tr>
          <td>无法显示窗口</td>
          <td>确保你用的是支持 GUI 的 WSL（如 WSLg 或 X11 桥接）</td>
      </tr>
      <tr>
          <td><code>torch.cuda.is_available(): False</code></td>
          <td>使用 <code>device=cpu</code></td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="-总结流程图">✅ 总结流程图</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Windows 摄像头
</span></span><span style="display:flex;"><span>     │
</span></span><span style="display:flex;"><span>     └───▶ FFmpeg（推送） ───▶ RTSP Server（Mediamtx）
</span></span><span style="display:flex;"><span>                                     │
</span></span><span style="display:flex;"><span>                                     ▼
</span></span><span style="display:flex;"><span>                            WSL YOLO（读取 RTSP 流识别）
</span></span></code></pre></div><h2 id="问题说明-1">问题说明 1</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>➜  python3 --version
</span></span><span style="display:flex;"><span>Python 3.8.10
</span></span><span style="display:flex;"><span>➜  pip --version
</span></span><span style="display:flex;"><span>/usr/bin/pip:6: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
</span></span><span style="display:flex;"><span>  from pkg_resources import load_entry_point
</span></span><span style="display:flex;"><span>pip 20.0.2 from /usr/lib/python3/dist-packages/pip <span style="color:#f92672">(</span>python 3.8<span style="color:#f92672">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>➜  git clone https://github.com/ultralytics/ultralytics
</span></span><span style="display:flex;"><span>Cloning into <span style="color:#e6db74">&#39;ultralytics&#39;</span>...
</span></span><span style="display:flex;"><span>remote: Enumerating objects: 61803, <span style="color:#66d9ef">done</span>.
</span></span><span style="display:flex;"><span>remote: Counting objects: 100% <span style="color:#f92672">(</span>201/201<span style="color:#f92672">)</span>, <span style="color:#66d9ef">done</span>.
</span></span><span style="display:flex;"><span>remote: Compressing objects: 100% <span style="color:#f92672">(</span>140/140<span style="color:#f92672">)</span>, <span style="color:#66d9ef">done</span>.
</span></span><span style="display:flex;"><span>remote: Total <span style="color:#ae81ff">61803</span> <span style="color:#f92672">(</span>delta 139<span style="color:#f92672">)</span>, reused <span style="color:#ae81ff">78</span> <span style="color:#f92672">(</span>delta 61<span style="color:#f92672">)</span>, pack-reused <span style="color:#ae81ff">61602</span> <span style="color:#f92672">(</span>from 3<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Receiving objects: 100% <span style="color:#f92672">(</span>61803/61803<span style="color:#f92672">)</span>, 33.73 MiB | 11.33 MiB/s, <span style="color:#66d9ef">done</span>.
</span></span><span style="display:flex;"><span>Resolving deltas: 100% <span style="color:#f92672">(</span>45988/45988<span style="color:#f92672">)</span>, <span style="color:#66d9ef">done</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>➜  cd ultralytics
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>➜  pip install -e .
</span></span><span style="display:flex;"><span>ERROR: File <span style="color:#e6db74">&#34;setup.py&#34;</span> not found. Directory cannot be installed in editable mode: /home/ultralytics
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>A <span style="color:#e6db74">&#34;pyproject.toml&#34;</span> file was found, but editable mode currently requires a setup.py based build.<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>➜  ls
</span></span><span style="display:flex;"><span>CITATION.cff  CONTRIBUTING.md  LICENSE  README.md  README.zh-CN.md  docker  docs  examples  mkdocs.yml  pyproject.toml  tests  ultralytics
</span></span></code></pre></div><h3 id="说明">说明</h3>
<p><strong>Ultralytics 现在是基于 <code>pyproject.toml</code> 的现代构建系统</strong>，而 <code>pip install -e .</code> 旧的可编辑模式要求有 <code>setup.py</code>，所以直接用会失败。</p>
<h3 id="解决方案">解决方案</h3>
<h4 id="用新的-pep-660-可编辑模式">用新的 PEP 660 可编辑模式</h4>
<p>Python 3.8+ + pip 21.3+ 才支持。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>python -m pip install --upgrade pip setuptools wheel
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>python3 -m pip --version
</span></span><span style="display:flex;"><span>pip 25.0.1 from /home/luyang/.local/lib/python3.8/site-packages/pip <span style="color:#f92672">(</span>python 3.8<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cd ultralytics
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>python3 -m pip install -e <span style="color:#e6db74">&#39;.[dev]&#39;</span>
</span></span></code></pre></div><h2 id="问题说明-2">问题说明 2</h2>
<p>第一次运行 yolo 时由于权重文件不存在，会先下载权重文件。如果下载过程中 ctrl c 异常结束后，再次运行就会报错。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>yolo detect predict model<span style="color:#f92672">=</span>yolo11n.pt source<span style="color:#f92672">=</span>./demo.mp4
</span></span><span style="display:flex;"><span>Traceback <span style="color:#f92672">(</span>most recent call last<span style="color:#f92672">)</span>:
</span></span><span style="display:flex;"><span>  File <span style="color:#e6db74">&#34;/home/max/.local/bin//yolo&#34;</span>, line 8, in &lt;module&gt;
</span></span><span style="display:flex;"><span>    sys.exit<span style="color:#f92672">(</span>entrypoint<span style="color:#f92672">())</span>
</span></span><span style="display:flex;"><span>  File <span style="color:#e6db74">&#34;/home/ultralytics/ultralytics/cfg/__init__.py&#34;</span>, line 956, in entrypoint
</span></span><span style="display:flex;"><span>    model <span style="color:#f92672">=</span> YOLO<span style="color:#f92672">(</span>model, task<span style="color:#f92672">=</span>task<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  File <span style="color:#e6db74">&#34;/home/ultralytics/ultralytics/models/yolo/model.py&#34;</span>, line 81, in __init__
</span></span><span style="display:flex;"><span>    super<span style="color:#f92672">()</span>.__init__<span style="color:#f92672">(</span>model<span style="color:#f92672">=</span>model, task<span style="color:#f92672">=</span>task, verbose<span style="color:#f92672">=</span>verbose<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  File <span style="color:#e6db74">&#34;/home/ultralytics/ultralytics/engine/model.py&#34;</span>, line 151, in __init__
</span></span><span style="display:flex;"><span>    self._load<span style="color:#f92672">(</span>model, task<span style="color:#f92672">=</span>task<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  File <span style="color:#e6db74">&#34;/home/ultralytics/ultralytics/engine/model.py&#34;</span>, line 295, in _load
</span></span><span style="display:flex;"><span>    self.model, self.ckpt <span style="color:#f92672">=</span> attempt_load_one_weight<span style="color:#f92672">(</span>weights<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  File <span style="color:#e6db74">&#34;/home/ultralytics/ultralytics/nn/tasks.py&#34;</span>, line 1549, in attempt_load_one_weight
</span></span><span style="display:flex;"><span>    ckpt, weight <span style="color:#f92672">=</span> torch_safe_load<span style="color:#f92672">(</span>weight<span style="color:#f92672">)</span>  <span style="color:#75715e"># load ckpt</span>
</span></span><span style="display:flex;"><span>  File <span style="color:#e6db74">&#34;/home/ultralytics/ultralytics/nn/tasks.py&#34;</span>, line 1447, in torch_safe_load
</span></span><span style="display:flex;"><span>    ckpt <span style="color:#f92672">=</span> torch_load<span style="color:#f92672">(</span>file, map_location<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;cpu&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  File <span style="color:#e6db74">&#34;/home/ultralytics/ultralytics/utils/patches.py&#34;</span>, line 118, in torch_load
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> torch.load<span style="color:#f92672">(</span>*args, **kwargs<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  File <span style="color:#e6db74">&#34;/home/max/.local/lib/python3.8/site-packages/torch/serialization.py&#34;</span>, line 1072, in load
</span></span><span style="display:flex;"><span>    with _open_zipfile_reader<span style="color:#f92672">(</span>opened_file<span style="color:#f92672">)</span> as opened_zipfile:
</span></span><span style="display:flex;"><span>  File <span style="color:#e6db74">&#34;/home/max/.local/lib/python3.8/site-packages/torch/serialization.py&#34;</span>, line 480, in __init__
</span></span><span style="display:flex;"><span>    super<span style="color:#f92672">()</span>.__init__<span style="color:#f92672">(</span>torch._C.PyTorchFileReader<span style="color:#f92672">(</span>name_or_buffer<span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>RuntimeError: PytorchStreamReader failed reading zip archive: failed finding central directory
</span></span></code></pre></div><h3 id="说明-1">说明</h3>
<p>关键日志：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>RuntimeError: PytorchStreamReader failed reading zip archive: failed finding central directory
</span></span></code></pre></div><p>意思是 PyTorch 在加载权重文件时发现文件不是一个有效的 .pt zip 格式，通常有几种原因：</p>
<ol>
<li><strong><code>yolo11n.pt</code> 文件损坏或下载不完整</strong>
<ul>
<li>Ultralytics 会在第一次运行时自动下载权重，如果网络中断或下载被墙，文件可能是空的或部分内容缺失。</li>
</ul>
</li>
<li><strong>路径错误，加载到了一个错误的文件</strong>
<ul>
<li>例如你目录下可能有一个同名空文件。</li>
</ul>
</li>
<li><strong>Python / PyTorch 版本和权重文件格式不兼容</strong>（概率小，但存在）</li>
</ol>
<h3 id="解决方案-1">解决方案</h3>
<h4 id="手动下载权重再运行">手动下载权重再运行</h4>
<p>从官方仓库下载：</p>
<p><code>wget https://github.com/ultralytics/assets/releases/download/v8.3.0/yolo11n.pt -O yolo11n.pt</code></p>
<p>然后：</p>
<p><code>yolo detect predict model=yolo11n.pt source=./demo.mp4</code></p>
</section></main>
        <footer id="main-footer"><div class="footer">
  <a href="#">Scroll to Top</a>
  <div class="footer-copyright">
    <div class="dim">© 2025 Lu Yang</div>
    <div>Made with ❤️ and powered by <a href="https://github.com/math-queiroz/rusty-typewriter" target="_blank">Rusty Typewriter</a> theme for <a href="https://gohugo.io/" target="_blank">Hugo</a></div>
  </div>
</div>
</footer>
      </div><aside id="side-pane" class="side-sticky"><div class="side-details">
    <span>556 words</span>
    <span>6 - 8 minutes read</span></div><h3>Table Of Contents</h3><nav id="TableOfContents">
  <ul>
    <li><a href="#环境声明">环境声明</a></li>
  </ul>

  <ul>
    <li><a href="#-场景说明">🧩 场景说明</a></li>
    <li><a href="#-环境配置wsl-中">⚙️ 环境配置（WSL 中）</a>
      <ul>
        <li><a href="#-安装依赖">✅ 安装依赖</a></li>
        <li><a href="#-安装-ultralytics源码模式">✅ 安装 Ultralytics（源码模式）</a></li>
      </ul>
    </li>
    <li><a href="#-步骤一安装并运行-rtsp-服务器mediamtx">✅ 步骤一：安装并运行 RTSP 服务器（mediamtx）</a>
      <ul>
        <li><a href="#安装wsl-中">安装（WSL 中）：</a></li>
      </ul>
    </li>
    <li><a href="#-步骤二windows-端摄像头推流ffmpeg">✅ 步骤二：Windows 端摄像头推流（FFmpeg）</a></li>
    <li><a href="#-步骤三wsl-中运行-yolo-目标检测">✅ 步骤三：WSL 中运行 YOLO 目标检测</a></li>
    <li><a href="#-可选调试-rtsp-流">✅ 可选：调试 RTSP 流</a></li>
    <li><a href="#-常见问题排查">💡 常见问题排查</a></li>
    <li><a href="#-总结流程图">✅ 总结流程图</a></li>
    <li><a href="#问题说明-1">问题说明 1</a>
      <ul>
        <li><a href="#说明">说明</a></li>
        <li><a href="#解决方案">解决方案</a></li>
      </ul>
    </li>
    <li><a href="#问题说明-2">问题说明 2</a>
      <ul>
        <li><a href="#说明-1">说明</a></li>
        <li><a href="#解决方案-1">解决方案</a></li>
      </ul>
    </li>
  </ul>
</nav><h3>Related</h3>
    <ul><li><a href="/posts/wsl-%E4%B8%BB%E9%A1%B5/">wsl 主页</a></li><li><a href="/posts/windows_wsl_ubuntu_adb_%E9%85%8D%E7%BD%AE/">Windows WSL ubuntu adb 配置</a></li><li><a href="/posts/vcpkg_windows/">windows vcpkg</a></li><li><a href="/posts/python2.7-%E7%8E%AF%E5%A2%83%E5%8F%8A%E5%8C%85%E7%AE%A1%E7%90%86/">python2.7 环境及包管理</a></li><li><a href="/posts/%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91-python-2.7.16/">交叉编译 Python-2.7.16</a></li></ul></aside></div>
  </div>
</body>
</html>
